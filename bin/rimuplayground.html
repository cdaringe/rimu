<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="description" content="An interactive sandbox for learning and
    experimenting with Rimu markup plus documentation.">
  <title>Rimu Playground</title>
  <style type="text/css">
    /*<![CDATA[*/
    body {
      margin: 1em;
      font-family: Helvetica, Arial, sans-serif;
    }
    h1, h2, h3, h4, h5, h6, th {
      color: #527bbd;
    }
    h1 {
      margin-bottom: 0.2em;
    }
    h1 a {
      color: #527bbd;
      text-decoration: none;
    }
    table#view {
      table-layout: fixed;
      border-collapse:collapse;
      width: 100%;
      text-align:left;
    }
    #view td, #view th {
      border: 2px solid #ddd;
      width: 33%;
      padding: 0.5em;
    }
    #view td {
      height: 200px;
      vertical-align:top;
    }
    #rimu {
      height: 100%;
      min-height: 800px; /* Non-WebKit browsers don't auto-resize textarea. */
      width: 100%;
      background-color: #ffe;
      border: 1px solid #ddd;
    }
    #html {
      white-space: pre-wrap;
      margin: 0;
    }
    #preview em, #preview strong {
      color: #295bad;
    }
    #preview code, pre {
      color: #474747;
      white-space: pre-wrap;
    }
    #preview pre {
      margin-left: 1em;
      /*background-color: #f8f8f8;*/
    }
    /*]]>*/
  </style>
</head>
<body>
  <h1><a href="http://rimumarkup.org/">Rimu Playground</a></h1>

  <p>
    <select id="topic"
            onchange="renderTopic(this.value)"
            onclick="renderTopic(this.value)">
      <option value="topic-anchors-and-links">Anchors and links</option>
      <option value="topic-api">API</option>
      <option value="topic-character-entities">Character entities</option>
      <option value="topic-comments">Comments</option>
      <option value="topic-delimited-blocks">Delimited blocks</option>
      <option value="topic-headers">Headers</option>
      <option value="topic-html-markup">HTML Markup</option>
      <option value="topic-html-attributes">HTML Attributes</option>
      <option value="topic-images">Images</option>
      <option value="topic-lists">Lists</option>
      <option value="topic-macros">Macros</option>
      <option value="topic-other">Other</option>
      <option value="topic-paragraphs">Paragraphs</option>
      <option selected value="topic-playground">Playground</option>
      <option value="topic-quotes">Quotes</option>
      <option value="topic-replacements">Replacements</option>
      <option value="topic-tools">Tools</option>
      <option value="topic-urls-and-email">URLs and email addresses</option>
    </select>
    <button onclick="stash();">Stash</button>
    <button onclick="unstash();">Unstash</button>
  </p>

  <table id="view">
    <thead>
      <tr>
        <th>Rimu</th>
        <th>Preview</th>
        <th>HTML</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          <textarea id="rimu" onkeyup="convert();">Enter markup here.</textarea>
        </td>
        <td id="preview">
        </td>
        <td>
          <pre id="html"></pre>
        </td>
      </tr>
    </tbody>
  </table>

<div id="topic-anchors-and-links">
<!--
Anchors are jump targets for links within the document.

Syntax:

  Role            Rimu            HTML
  _________________________________________________________
  Inline anchor   <<#id>>         <span id="id"></span>
  Block anchor    <<#id>>         <div id="id"></div>
  Link            <#id|caption>   <a href="#id">caption</a>
  Link            <#id>           <a href="#id">#id</a>
  _________________________________________________________

- Block and inline anchor elements share the same syntax.
- Links are inline elements.

Examples:

- -
Refer to the <#x1|next paragraph> or the <#x2|second list item
below>.

<<#x1>>
Nisl curabitur donec. Vel porttitor et. Et amet vitae. Quam
porttitor integer. Bibendum neque quis quisque ac commodo. Non et
cumque. Sit et a consequat.

- Viverra pede turpis.
- <<#x2>>Esse et dui nonummy modi.
- -

See also the _URLs and email addresses_ topic.

-->
</div>

<div id="topic-api">
<!--
Rimu has just one API:

  render(source [, options])

Where `source` is a string containing Rimu markup and `options` is an
optional object argument with zero or more of the following
properties:

`safeMode`:: This option has a number value that controls how Rimu
renders embedded HTML:

  0 => Render the raw HTML (default behavior).
  1 => Delete the HTML.
  2 => Replace the HTML with the 'htmlReplacement' option string.
  3 => Render HTML as text.

`htmlReplacement`:: A string that replaces embedded HTML when
`safeMode` is set to `2`. Defaults to `<mark>replaced HTML</mark>`.

Example:

  Rimu.render('Hello *Rimu*!', {safeMode: 1});

See `rimuc.js` and `rimuplayground.html` for examples of `render()`
in action.

-->
</div>

<div id="topic-character-entities">
<!--
HTML character entities can be included in Rimu source.

Examples: &copy; &reg; &alpha; &omega;

Character entities can be escaped with a backslash character prefix.

-->
</div>

<div id="topic-comments">
<!--
A _multi-line comment_ starts with a line containing only `/*` and
ends with a line containing only `*/` for example:

  /*
    This comment does not appear in the
    rendered HTML.
  */

A _single-line comment_ is any line of text starting with `//`
for example:

  // This comment does not appear in the rendered HTML.

- Comments are not included in the HTML output.
- Comments are block elements and cannot be used inline, for example
  mid-paragraph.
- Comment delimiters must start at the left margin.
- Use HTML comments if you want comments to appear in the rendered
  HTML.
- Comments can be escaped by prefixing the opening delimiter with a
  backslash character.

-->
</div>

<div id="topic-delimited-blocks">
<!--
Delimited blocks are blocks of one or more lines bounded by opening
and closing delimiter lines. Delimited blocks can be escaped with a
backslash character prefix.

*Code Block*

- -
A code block expands macro invocations but all other inline
elements are rendered verbatim. Rendered with  HTML <pre><code>
elements.

The delimiter lines are two or more dash characters starting at the
left margin.
- -

*Quote Block*

""
A _Quote Block_ renders the enclosed block elements inside an HTML
`<blockquote>` element.

The delimiter lines are two or more double-quote characters starting
at the left margin.
""

*Division Block*

..
A _Division Block_ is a container for other block elements, the
contained elements are enclosed by an HTML `<div>` element.

- The delimiter lines are two or more period characters starting at
  the left margin.
- The _Division Block_ is can be used to group block elements so
  they can be attached to a list item (this allows arbitrarily complex
  list items).
..

-->
</div>

<div id="topic-headers">
<!--
A _Header_ is a single-line block element containing a title which is
prefixed by 1 to 6 `=` or `#` characters (the header ID). A postfixed
header ID is optional.

Examples:

# h1 header
== h2 header ==
#### h3 header
#### h4 _header_ ####
===== h5 header
====== h6 header

- The header ID is separated from the title text by whitespace.
- Inline elements are allowed in the header title.

-->
</div>

<div id="topic-html-markup">
<!--
Block and inline HTML elements can be <span style="font-size:
2em">mixed with</span> Rimu markup.

<table>
  <tr>
    <td>Montes adipiscing sodales.</td>
    <td>Magna placerat posuere.</td>
  </tr>
  <tr>
    <td>Nulla suspendisse egestas nulla libero sed.</td>
    <td>Wisi ullamcorper eget.</td>
  </tr>
</table>

- The opening tag of an HTML block element must start at the left
  margin.
- An HTML block element is terminated with a blank line (it cannot
  contain blank lines).
- HTML tags can be escaped with a backslash character prefix.
- HTML elements can be excluded from the output using the API
  _safeMode_ option (see the _API_ topic).

-->
</div>

<div id="topic-html-attributes">
<!--
The _HTML Attributes_ single-line block element injects HTML
attributes into the opening tag of the next block element. You can
specify class names, an element ID and any other HTML attributes.

Syntax:

  .[class names][#id][[attributes]]

- `class names` is one or more HTML _class_ attribute names (separated
  by spaces).
- `id` is a unique HTML _id_ attribute value.
- `attributes` is one or more HTML attribute name/value pairs.
- HTML attributes can be applied any block element that renders HTML.
- The leading period character must start at the left margin and
  must not extend beyond the end of the line.
- The `[attributes]` section is skipped if the API _safeMode_ option
  is not zero (see the _API_ topic).

Here are a couple of examples of attribute elements applied to the
paragraph block elements:

.error [style="color:red"]
Lorum ipsum.

.info #ref2 [style="color:green"]
Ac curabitur elementum.

{quote-style} = '.[style="padding-left: 10px; border-left: 4px solid silver;"]'

{quote-style}
""
Lorem ipsum dolor sit amet sapien. Nascetur et mattis maecenas morbi
porttitor. Vitae vestibulum voluptate. Quam elit id. In eu wisi.
Imperdiet pellentesque minim. Metus mauris tortor. Torquent leo vel.
""

-->
</div>

<div id="topic-images">
<!--
Syntax:

  Rimu              HTML
  ____________________________________________
  <image:url|alt>   <img href="url" alt="alt">
  <image:url>       <img href="url" alt="url">
  ____________________________________________

An image can be rendered as a block element:

<image:http://www.w3.org/Icons/w3c_home.png|W3C logo>

Or an image can be <image:http://www.w3.org/Icons/w3c_home.png> an
inline element.

-->
</div>

<div id="topic-lists">
<!--
List items are prefixed with a list ID which identifies the list type
and groups list items into lists.

  List IDs             List type
  __________________________________
  -, *, **, ***, ****  Bullet list
  ., .., ..., ....     Numbered list
  ::, :::, ::::        Labeled list
  __________________________________

- List items can be indented but this has no semantic significance.
- Number list IDs can be prefixed with numbers but they have no
  semantic significance.
- List items can be escaped with a backslash at the beginning of the
  line.
- If a delimited block (_Code_, _Quote_ or _Division_ block) or an
  _Indented_ paragraph immediately follows a list item then it is
  rendered with the list item.
- There are no explicit numbering or bullet styles, this is best left
  to CSS which can apply a consistent set of list styles.

Examples:

- Lorem ipsum dolor sit amet dis quisque maecenas in tristique arcu
\- lorem dolor fusce nec.
  * Sit pretium quisque in wisi lobortis.
  * Ac curabitur elementum.
    ** Platea ad diam arcu vitae fermentum.
       1. Eu lorem nulla.
       2. In suspendisse at dapibus nostra est.
          .. Montes adipiscing sodales.
    ** Pellentesque nibh sit.
- Viverra pede turpis.
  Esse et dui:: Nonummy modi.
  Wisi ad diam:: Sapien porttitor.
    Condimentum::: Lacus maecenas neque dolor habitant tellus eu vitae sed
- Augue et dui malesuada purus.

  Purus aliquam mauris a aliquam orci. Massa sit sit. Quis eget
  penatibus. Maecenas at tellus. Sapien quam mauris. Sapien arcu nisl.
  Non a pede in.

- Facilisi vestibulum montes quam eget donec.
..
Cras proin molestie quam sem conubia. Ligula vel elit. Elit a earum.
Arcu eget magna. Class vivamus morbi.

Ac lacinia mi. Mi in enim. Dui sed ut. Egestas congue quam. Facilisis
non magnis facilisi scelerisque luctus. Quis praesent pulvinar.
..
- Integer quisque hendrerit. Arcu nunc lorem posuere.

-->
</div>

<div id="topic-other">
<!--
- By convention Rimu markup text files have a `.rmu` file name
  extension.

-->
</div>

<div id="topic-paragraphs">
<!--
Paragraph block elements are always followed by a blank line. There
are two paragraph types:

==== Normal paragraphs
Normal paragraphs can contain inline elements, the first line must
start at the left margin.

You can force line breaks \
in normal paragraphs by   \
putting a space followed  \
by a backslash character  \
at the end of a line.

Line breaks can be escaped by prefixing the trailing backslash
character with a backslash.

==== Indented paragraphs
  _Indented paragraphs_ expand macro invocations but all other
  inline elements are rendered verbatim. Indented paragraphs are
  rendered with an HTML <pre> element.

-->
</div>

<div id="topic-playground">
<!--
This is the _Rimu Playground_, it's an interactive sandbox
for learning and experimenting with Rimu markup:

- Select from the drop-down list to view Rimu documentation topics.
- Enter Rimu source in the _Rimu_ text area, the _Preview_ and _HTML_
  are displayed as you type.
- Use _Stash_ to save the current Rimu source and _Unstash_
  to restore it later.
- The Playground is a single file stand-alone HTML application,
  all processing in the browser (no data is sent from the browser).
- You can find out more about Rimu Markup at
  <http://rimumarkup.org|rimumarkup.org>

-->
</div>

<div id="topic-quotes">
<!--
Text can be formatted by enclosing it with quote characters. The
built-in quote characters are: underscore for _emphasized text_;
asterisk for *bold text*; back-tick for `monospaced text`.

  Rimu            HTML                      Font style
  ___________________________________________________________
  _emphasis_      <em>emphasis</em>         Italic
  *strong*        <strong>strong</strong>   Bold
  `code`          <code>code</code>         Monospaced
  ___________________________________________________________

- Quotes and inline elements can be nested within a quote with the
  exception of the _code_ quote which displays enclosed elements verbatim.
- Quotes can be escaped with backslash character prefixes.
- Quoted text must begin and end with non-whitespace characters and
  cannot end with a backslash character.

You can modify existing quote behavior or add new quotes using _Quote
definitions_.

Definition syntax:

  quote-character = 'quote-template'

Where `quote-character` is a single character and `quote-template`
specifies the markup tags that envelope the quoted output text.
For example:

  ~ = '<del>|</del>'

The `|` character separates the open and close tags. If a two-bar `||`
separator is used the quoted text is displayed verbatim like the
built-in _code quote_.

- A quote definition must start at the left margin and must not
  extend beyond the end of the line.
- The `quote-template` can invoke previously defined macros.
- Quote definitions are not processed if the _Safe Mode_ is non-zero.

-->
</div>

<div id="topic-macros">
<!--
Macros provide a mechanism for creating shortcuts for repeatedly used markup.
They are used to parametrize documents, promote clarity and eliminate repetition.

Macro definitions contain Rimu markup and can be invoked anywhere you
would use an inline or block element.

Definition syntax:

  \{macro-name} = 'macro-value'

Invocation syntax:

  \{macro-name}
  \{macro-name?default-value}
  \{macro-name|param1[|param2...]}
  \{macro-name=pattern}
  \{macro-name!pattern}

- Macro definition values are enclosed by single quotes and can extend
  over multiple lines.
- A macro name consists of one or more alphanumeric, underscore or
  dash characters.
- A macro definition must start at the left margin.
- Macro definition values can invoke previously defined macros but
  macro invocations cannot be nested.
- Macro definitions and invocations can be escaped with a backslash
  character prefix.
- Macro invocations are expanded everywhere, including inside
  _code quotes_ and _code blocks_.
- _Parametrized_ macro invocations replace the `$1`, `$2` ... strings
  in the macro definition with the `param1`, `param2` ... values.
- Macro invocation parameters contain inline Rimu markup; inline
  parameter values can span multiple lines.
- Omitted parameter values default to an empty string.
- Invocations of undefined macros are replaced with a blank string
  or the `default-value` if the `\{macro-name?default-value}`
  _Existential_ invocation syntax is used.
- The `\{macro-name=pattern}` _Inclusion_ invocation is replaced by a
  blank string if the macro value matches the `pattern` (where `pattern`
  is a JavaScript regular expression).
  If the macro value does not match the `pattern` the containing line
  is skipped.
  This feature can be used to conditionally include lines of source text.
  * If the macro is undefined its value is treated as a blank string for the
    purpose of pattern matching.
  * If the `pattern` contains `}` characters they must be escaped with a
    backslash character (otherwise they will be mistaken for the macro
    closing brace).
- The `\{macro-name!pattern}` _Inclusion_ invocation syntax is the inverse
  of the `\{macro-name=pattern}` syntax i.e. the macro invocation is replaced
  by a blank string if the macro value does not match the `pattern`, if it
  does match the containing line is skipped.
- Macro definitions are not processed if the _Safe Mode_ is
  non-zero.

Examples:

- -
\{description} = 'Sapiente nec vestibulum integer sit qui. Libero pede
posuere.  Erat ullamcorper enim per fusce aliquam interdum penatibus
et sed auctor ac.  Lectus consectetuer neque.'
\{homepage} = '<http://www.example.com|Foobar home page>'

Visit the \{homepage}.

\{info} = '<span class="label label-info">$1</span>'

\{info|Heads up!}
\{info|As you were!}
- -

-->
</div>

<div id="topic-replacements">
<!--
A _Replacement_ replaces matched source text with some other text
(usually HTML markup). A replacement is defined by a regular
expression (to find the matched text) and the text to be replaced.

Definition syntax:

  /pattern/flags = 'replacement'

- The `/pattern/flags` regular expression syntax is identical to JavaScript's
  <https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\_Objects/RegExp|RegExp
  literal> syntax.
- `$1`, `$2`... in `replacement` are replaced by the corresponding
  regular expression match groups.
- Replacements are only expanded in inline contexts.
- Replacements are not expanded inside _Code quotes_, _Code blocks_
  or _Indented paragraphs_.
- If the first matched character is a backslash then replacement will
  be escaped i.e. starting the regular expresssion with `\\?` will
  ensure it can be escaped.
- A replacement definition must start at the left margin and must not
  extend beyond the end of the line.
- The `replacement` text can invoke previously defined macros.
- Replacement definitions are not processed if the _Safe Mode_ is
  non-zero.

Example replacement definitions:

- -
/\.\{3}/ = '&hellip;'
/\bTODO\b/ = '<b style="color: red; background-color: yellow;">TODO</b>'
- -

-->
</div>

<div id="topic-tools">
<!--
==== Rimuc
_rimuc_ is a Node.js command-line tool that converts Rimu source to
HTML.

- -
NAME
  rimuc - convert Rimu source to HTML

SYNOPSIS
  rimuc [OPTIONS...] [FILES...]

DESCRIPTION
  Reads Rimu source markup from stdin, converts it to HTML
  then writes the HTML to stdout. If FILES are specified
  the Rimu source is read from FILES.

  If a file named .rimurc exists in the user's home directory
  then its contents is processed after - -prepend sources but before
  any other inputs. Rendered with safe-mode 0.

OPTIONS
  -h, - -help
    Display help message.

  -o, - -output OUTFILE
    Write output to file OUTFILE instead of stdout.

  -p, - -prepend SOURCE
    Process the SOURCE text before other inputs.
    Rendered with safe-mode 0.

  - -safe-mode NUMBER
    Specifies how to process inline and block HTML elements.
    - -safe-mode 0 renders raw HTML (default),
    - -safe-mode 1 drops raw HTML,
    - -safe-mode 2 replaces raw HTML with text 'replaced HTML'.
    - -safe-mode 3 renders raw HTML as text.

  -s, - -styled
    Include HTML header and footer and CSS styling in output.
    If one source file is specified the output is written to
    same-named file with .html extension.
    Styled using Bootstrap.
    Set the \{highlightjs} macro to a non-blank value to enable
    syntax highlighting with Highlight.js.
    Set the \{mathjax} macro to a non-blank value to enable MathJax.

- -

Example usage:

1. Use _rimuc_ as a filter:

  echo 'Hello *Rimu*!' | rimuc

2. Generate styled HTML Web page and use MathJax to process MathML:

  rimuc - -styled - -prepend "\{mathjax}='yes'" showcase.rmu

3. Compile multiple source files to single output file:

  rimuc -o book.html frontmatter.rmu chapter*.rmu backmatter.rmu

==== Vim syntax file
The Rimu distribution includes a
<https://raw.github.com/srackham/rimu/master/tools/vim/syntax/rimu.vim|syntax
highlighter> for the Vim editor. Copy `rimu.vim` to your
`$HOME/.vim/syntax` directory and then use the Vim `:set syn=rimu`
command or put this line in your `$HOME/.vimrc` file to enable Rimu
syntax highlighting:

  autocmd BufRead,BufNewFile *.rmu setlocal filetype=rimu

The syntax file also sets Vim text formatting options, if they're not
to your taste delete them from the end of the file.

-->
</div>

<div id="topic-urls-and-email">
<!--
Syntax:

  Rimu              HTML
  ____________________________________________________
  <url|caption>     <a href="url">caption</a>
  <url>             <a href="url">url</a>
  <email|caption>   <a href="mailto:email">caption</a>
  <email>           <a href="mailto:email">email</a>
  ____________________________________________________

Examples:

  <http://example.com|Foo home>
  <http://example.com>
  <chapter1.html>
  <chapter2.html#basics|the basics>
  <#x1|preface>
  <file:///home/joe/doc/user-guide.pdf|user guide>
  <file:///home/joe/downloads/>
  <ftp://ftp.funet.fi/pub/standards/RFC/rfc959.txt>
  <joe@example.org|Joe Bloggs>
  <joe@example.com>

-->
</div>

  <script type="text/javascript" src="rimu.js"></script>
  <script type="text/javascript">
    // <![CDATA[
    function escapeSpecialChars(s) {
      return s.replace(/&/g, '&amp;')
              .replace(/>/g, '&gt;')
              .replace(/</g, '&lt;');
    }
    // Strip leading and trailing whitespace.
    function trim(s) { return s.replace(/^\s+|\s+$/g,''); }
    function convert() {
      var source = document.getElementById('rimu').value;
      var htmlRaw = Rimu.render(source);
      var htmlEscaped = escapeSpecialChars(htmlRaw);
      var htmlElement = document.getElementById('html');
      var previewElement = document.getElementById('preview');
      htmlElement.innerHTML = htmlEscaped;
      previewElement.innerHTML = htmlRaw;
    }
    var stashText = '';
    function stash() {
      if (!window.sessionStorage) {
        alert('This browser does not support local sessionStorage.'); // IE, I'm talking to you!
        return;
      }
      var rimuElement = document.getElementById('rimu');
      sessionStorage['stash'] = rimuElement.value;
    }
    function unstash() {
      var rimuElement = document.getElementById('rimu');
      rimuElement.value = sessionStorage['stash'];
      convert();
    }
    // Render documentation topic stored in comment inside div with topic id.
    function renderTopic(topicId) {
      if (!topicId) {
        topicId = document.getElementById('topic').value;
      }
      var commentDiv = document.getElementById(topicId);
      if (!commentDiv) {
        alert('Missing topic: ' + topicId);
        return;
      }
      var rimuElement = document.getElementById('rimu');
      var htmlElement = document.getElementById('html');
      var previewElement = document.getElementById('preview');
      // Retrieve comment from topic divs.
      var source;
      for (var i in commentDiv.childNodes) {
        if (commentDiv.childNodes[i].nodeType === 8) {
          source = commentDiv.childNodes[i].nodeValue;
          break;
        }
      }
      source = trim(source);
      source = source.replace(/- -/mg, '--'); // Because -- is illegal in an HTML comment.
      var html = Rimu.render(source);
      rimuElement.value = source;
      htmlElement.innerHTML = escapeSpecialChars(html);
      previewElement.innerHTML = html;
    }
    window.onload = function () { renderTopic(); };
    // ]]>
  </script>
</body>
</html>
