<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title> </title>
  <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css">
  <link rel="stylesheet" href="http://yandex.st/highlightjs/7.3/styles/default.min.css">
  <style>
    /* Bootstrap tweaks. */
    body {
      margin: 1em;
      max-width: 50em;
    }
    h1, h2, h3, h4, h5, h6 { color: #527bbd; }
    h1 { font-size: 2.2em; }
    h2 { font-size: 1.5em; }
    h3 { font-size: 1.2em; }
    h4 { font-size: 1.0em; }
    h5 { font-size: 0.9em; }
    h6 { font-size: 0.9em; }
    h2, h3, h4, h5, h6 {
      line-height: normal;
      margin-top: 1.5em;
      margin-bottom: 0.2em;
    }
    h2 {
      border-bottom: 1px solid rgba(0, 0, 0, 0.15);
    }
    a, a:hover { color: #527bbd; }
    li, dd {
      margin-bottom: 0.25em;
    }
    p, pre, ul, ol, dl {
      margin-top: 0.5em;
      margin-bottom: 0.5em;
    }
    pre {
      padding: 6px;
    }
    code {
      color: inherit;
      font-size: inherit;
    }
    *:not(pre) > code {
      white-space: normal;
      border: none;
      background-color: #fafafa;
    }
    /* highlight.js tweaks. */
    pre > code {
      background-color: inherit;
      padding: 0;
    }
    pre span {
      opacity: 1 !important;
    }
  </style>
</head>
<body>
<h1>Rimu Tips</h1>
<h2>HTML is valid Rimu</h2>
<p>You are free to mix any valid HTML into a Rimu document &mdash; no
special syntax or relearning  is required (in this sense Rimu can be
thought of as an HTML superset).</p>
<h2>Converting Rimu to PDF</h2>
<p>First convert Rimu markup to HTML and then convert the HTML to PDF.</p>
<p>Google's Chrome web browser has an option to print HTML to a PDF file,
other browsers have PDF add-ons that perform the same function.</p>
<p>Alternatively use an HTML to PDF conversion program, here is
<a href="tips.pdf">tips.pdf</a> generated with this <a href="http://www.htmldoc.org/">HTMLDOC</a>
command (it generates a title page and a table of contents but the
fidelity is not as good as printing HTML to PDF from the browser):</p>
<pre>htmldoc -f doc/tips.pdf  doc/tips.html</pre>
<h2>Extend Rimu with Macros</h2>
<p>Macros provide a simple, consistent mechanism for extending the Rimu
markup vocabulary. For example the following sidebar:</p>
<h4>Fun with Macros</h4>
<div style="padding-left: 10px; border-left: 4px solid silver;"><p><span class="label label-info">Heads up!</span> See the <a href="http://rimumarkup.org/rimuplayground.html">Rimu Playground</a> for documentation and hands-on
experimentation.</p>
<p><span class="label label-info">Note</span> <mark>This document is not yet finished.</mark></p></div>
<p>Was generated by this Rimu markup:</p>
<pre><code>{sidebar} = '==== $1
.[style="padding-left: 10px; border-left: 4px solid silver;"]'
{info} = '&lt;span class="label label-info"&gt;$1&lt;/span&gt;'
{heads-up} = '{info|Heads up!}'
{note} = '{info|Note} &lt;mark&gt;$1&lt;/mark&gt;'
{playground} = '&lt;http://rimumarkup.org/rimuplayground.html|Rimu Playground&gt;'

{sidebar|Fun with Macros}
..
{heads-up} See the {playground} for documentation and hands-on
experimentation.

{note|This document is not yet finished.}
..</code></pre>
<ul><li>The <code>{sidebar}</code> macro illustrates how you can create custom text
  blocks by styling Rimu Division Blocks.
</li><li>Note how macro definitions can span multiple lines and can contain
  any valid Rimu markup (including HTML and blank lines).
</li></ul><h2 id="syntax-highlighting">Syntax highlighting</h2>
<p><a href="https://github.com/isagalaev/highlight.js">Highlight.js</a> is a nice
syntax highlighter that makes it trivial to add syntax highlighting to
Rimu code blocks.  The <em>rimuc</em> tool <code>--styled</code> option includes
Highlight.js if you set the <code>{highlightjs}</code> macro to a non-blank
value. It does this by linking to CSS and JavaScript files on the
<em>Highlight.js</em> website.</p>
<p><em>Highlight.js</em> automatically detects the language in the code block,
but you can also set the language explicitly by setting the code block
class, for example:</p>
<pre>.javascript
--
function die(message) {
  console.error(message);
  process.exit(1);
}
--</pre>
<p>Set the <code>no-highlight</code> class too disable syntax highlighting for a
code block.</p>
<h2>Syntax shared with Markdown</h2>
<p>The following subset of <em>Rimu</em> elements is compatible with Markdown:</p>
<dl><dt>Headers</dt><dd> Headers using <code>#</code> character header IDs.
</dd><dt>Code blocks</dt><dd> Indented paragraphs (at least four spaces)
render like Markdown code blocks.
</dd><dt>Text formatting</dt><dd> <code>_emphasis_</code> and <code>`code`</code> quotes.
</dd><dt>Lists</dt><dd>
<ul><li>Bullet lists with <code>-</code> and <code>*</code> IDs.
</li><li>Numbered lists with explicit numbering.
</li></ul></dd><dt>URLs and Email addresses</dt><dd> Using the <code>&lt;url&gt;</code> and <code>&lt;email&gt;</code> syntaxes.
</dd></dl><p>The Rimu <em>README</em> uses this subset for compatibility with <em>GitHub</em> and
<em>npmjs.org</em> README formats.</p>
<h2>Escaping Rimu syntax</h2>
<p>If you have text that you don't want interpreted as a Rimu element
then you can render it literally (escape it) by prefixing the element
with a backslash character.</p>
<h2>Passing macro values into Rimu documents</h2>
<p>You can do this by prepending text containing macro definitions to
Rimu source before rendering the source. The <em>rimuc</em> command has a
<code>--prepend</code> option that can be used to do this.</p>
<p>Alternatively you could also put macro definitions in a
separate file and specify it as the first Rimu source file in the
<em>rimuc</em> command.</p>
<p>The following example sets the HTML <em>title</em> in the <code>kotlin-notes.html</code>
output document:</p>
<pre>rimuc --styled --prepend "{title}='Kotlin Notes'" kotlin-notes.rmu</pre>
<h2>Putting | and } characters in macro parameter values</h2>
<p>Use the corresponding character entities <code>&amp;vert;</code> and <code>&amp;rbrace;</code>.</p>
<h2>Syntax checker</h2>
<p>The Vim editor syntax highlighter is a big help when writing (and
reading) Rimu markup.</p>
<h2>The Rimu markup looks ok but the generated HTML is wrong</h2>
<p>Using an editor with Rimu syntax highlighting support (see previous
topic) makes it much easier to spot syntax errors.</p>
<h2>Display contiguous block images vertically</h2>
<p>Unless they are separated by other block elements, multiple block
image elements flow inline like text (this is because the HTML <code>img</code>
element is an "inline block" element), you can flow them vertically by
enclosing them in a <em>Division Block</em> (HTML <code>div</code> element), for
example:</p>
<pre>&lt;image:http://www.w3.org/Icons/w3c_home.png|W3C logo&gt;
..
.#big-logo [width="150"]
&lt;image:http://www.w3.org/Icons/w3c_home.png|W3C logo&gt;
..</pre>
<p>Renders:</p>
<img src="http://www.w3.org/Icons/w3c_home.png" alt="W3C logo">
<div><img id="big-logo" width="150" src="http://www.w3.org/Icons/w3c_home.png" alt="W3C logo"></div>
<h2>Entering non-ASCII characters</h2>
<p>A number of non-ASCII Unicode characters are commonly used for
punctuation e.g.  em dash, ellipsis and quotation characters. You can
enter these characters (or any Unicode character) as HTML character
entities or you can enter them literally.</p>
<p>For example, to enter an ellipsis you could either enter <code>&amp;hellip;</code> or
you could enter the actual … character directly (alternatively you
could define a <em>Replacement</em> for the ellipsis, see the
<a href="#example-rimurc">Example .rimurc file</a> below). The mechanism for
entering Unicode characters directly will be dictated your editor:</p>
<dl><dt>Vim</dt><dd> Enter <em>Ctrl+V</em> followed by the the character <em>u</em> followed by the
hexidecimal character code e.g. to enter an em dash enter <em>Ctrl+V</em>
followed by <em>u2014</em>
</dd><dt>Linux console input</dt><dd> Enter <em>Ctrl+Shift+U</em> followed by the hexadecimal
character code followed by the <em>Enter</em> key.
</dd></dl><p>Common Unicode characters:</p>
<pre>Character     HTML entity    Hexadecimal code
---------     -----------    ----------------
—             &amp;mdash;        2014
…             &amp;hellip;       2026
“             &amp;ldquo;        201c
”             &amp;rdquo;        201d
→             &amp;rightarrow;   2192</pre>
<p>Here's a full list of
<a href="http://dev.w3.org/html5/html-author/charref">HTML5 character
entities</a>.</p>
<h2>Whitespace and Underscores in URLs</h2>
<p>Whitespace characters are illegal in URL paths, use <em>%20</em> in place of
spaces, for example:</p>
<pre>&lt;file:///home/srackham/books/War%20and%20Peace.pdf|War and Peace&gt;</pre>
<p>Underscore characters are legal in URL paths but they may be
interpreted as Rimu emphasis quotes, you can use <em>%5F</em> in place of
underscores or escape them with backslashes.</p>
<div id="defs-warning"></div>
<h2>Use Replacement and Quote definitions sparingly</h2>
<p>Adding new Replacement and Quote definitions changes the Rimu syntax
which can produce unexpected results. It can also make your Rimu
source non-portable and less readable.</p>
<div id="example-rimurc"></div>
<h2>Example .rimurc file</h2>
<p>Here is an example <code>.rimurc</code> file containing <em>Macro</em>, <em>Quote</em> and
<em>Replacement</em> definitions (refer to the Rimu documentation under
<em>Tools</em>):</p>
<pre><code>/*
  Replacements
*/
// Don't match HTML comment tags.
/(^|[^!])--(?!&gt;)/ = '$1&amp;mdash;'
/\.{3}/ = '&amp;hellip;'
/``/ = '&amp;ldquo;'
/''/ = '&amp;rdquo;'
// Don't match HTML close comment tag.
/(^|[^-])-&gt;/ = '$1&amp;rightarrow;'
/&lt;-/ = '&amp;leftarrow;'
/\bTODO\b/ = '&lt;b style="color: red; background-color: yellow;"&gt;TODO&lt;/b&gt;'
/^(NOTE|IMPORTANT|WARNING|TIP):/ = '&lt;b&gt;$1&lt;/b&gt;:'
// Alternative (typing friendly) emphasis, works for most cases but
// can't contain quotes.
/\B'\b(.+?)\b'\B/g = '&lt;em&gt;$1&lt;/em&gt;'
// Do not process the  deprecated + line break.
/[\\ ]\+(\n|$)/g = ' +$1'
// Open URLs in a new browser tab.
// /\\?&lt;(\S+?)&gt;/ = '&lt;a href="$1" target="_blank"&gt;$1&lt;/a&gt;'
// /\\?&lt;(\S+?)\|([\s\S]+?)&gt;/ = '&lt;a href="$1" target="_blank"&gt;$2&lt;/a&gt;'

/*
  Macros
*/
{mark} = '&lt;mark&gt;$1&lt;/mark&gt;'
{del} = '&lt;del&gt;$1&lt;/del&gt;'
{ins} = '&lt;ins&gt;$1&lt;/ins&gt;'
{sup} = '&lt;sup&gt;$1&lt;/sup&gt;'
{sub} = '&lt;sub&gt;$1&lt;/sub&gt;'

/*
  Quotes
*/
~ = '&lt;del&gt;|&lt;/del&gt;'</code></pre>
<h2>Extending the Vim syntax highligher</h2>
<p>If you've added custom replacements and quotes you can highlight them
in Vim by creating a custom <code>~/.vim/after/syntax/rimu.vim</code> syntax
file. Vim loads this file after the distributed
<code>~/.vim/syntax/rimu.vim</code> file. The following example
<code>~/.vim/after/syntax/rimu.vim</code> syntax file highlights the admonitions
replacement and the strike-through quote definitions from the previous
example <code>.rimurc</code> file:</p>
<pre><code>syn match rimuAdmonition /^\(NOTE\|IMPORTANT\|WARNING\|TIP\):/ containedin=ALLBUT,rimuComment,rimuCodeBlock
hi def link rimuAdmonition Special

syn match rimuSpanDeleted /\\\@&lt;!\~[ \t\n]\@!\(.\|\n\(\s*\n\)\@!\)\{-1,}[\\ \t\n]\@&lt;!\~/ contains=rimuSpanEntity
hi def link rimuSpanDeleted Todo</code></pre>
<h2>Understanding substitution priorities</h2>
<p>Inline elements are processed in the following order (first to last):</p>
<ol><li>Macros
</li><li>Quotes
</li><li>Replacements
</li><li>Special characters
</li></ol><h2>Using Macro, Replacement and Quote definitions in Safe Mode</h2>
<p><em>Macro</em>, <em>Replacement</em> and <em>Quote</em> definitions are not processed in
Safe Mode. To apply Macro, Replacement or Quote definitions to Rimu
markup processed in Safe Mode you need to load the definitions with a
separate API call, for example:</p>
<pre><code>Rimu.render(trusted_rimu_definitions); // safeMode is off by default.
var html = Rimu.render(untrusted_rimu_markup, {safeMode: 1});</code></pre>
<h2>Escaping Macro and Replacement parameters</h2>
<p>You can escape <code>$1</code>, <code>$2</code>&hellip; parameters in <em>Macro</em> and <em>Replacement</em>
definitions by using the <code>&amp;dollar;</code> character entity instead of the
dollar character.</p>
<h2>Modifying built-in Quotes and Replacements</h2>
<p>You can (with <a href="#defs-warning">caveats</a>) redefine built-in <em>Quotes</em> and
<em>Replacements</em>, here are a couple of examples:</p>
<pre><code>_ = '&lt;em class="emphasis"&gt;|&lt;/em&gt;'
/\\?&lt;(\S+@[\w\.\-]+)&gt;/g = '&lt;a class="mailto" href="mailto:$1"&gt;$1&lt;/a&gt;'</code></pre>
<p>Refer to the Rimu source files
<a href="https://github.com/srackham/rimu/blob/master/src/quotes.ts">quotes.ts</a>
and
<a href="https://github.com/srackham/rimu/blob/master/src/replacements.ts">replacements.ts</a>.</p>
<h2>Mathematical formulae using MathJax</h2>
<p>You can include math formulas written in LaTeX or MathML using
<a href="http://www.mathjax.org/">MathJax</a>. The <code>rimuc</code> command <code>--styled</code>
option will include MathJax support if the <code>{mathjax}</code> macro is
defined. For example, this Rimu source:</p>
<pre><code>{mathjax} = 'yes'

A LaTeX inline formula: \(\sum_\{i=0}^n i^2 = \frac{n^2+n}m\{2}\)

A LaTeX block formula:

\[\sum_\{i=0}^n i^2 = \frac{n^2+n}m\{2}\]

A MathML inline formula:
&lt;math&gt;
  &lt;mi&gt;E&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;
&lt;/math&gt;

A MathML block formula:

&lt;math display="block"&gt;
  &lt;mi&gt;E&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;
&lt;/math&gt;</code></pre>
<p>Renders:</p>
<p>A LaTeX inline formula: \(\sum_{i=0}^n i^2 = \frac{n^2+n}m{2}\)</p>
<p>A LaTeX block formula:</p>
<p>\[\sum_{i=0}^n i^2 = \frac{n^2+n}m{2}\]</p>
<p>A MathML inline formula:
<math>
  <mi>E</mi><mo>=</mo><mrow><mi>m</mi><msup><mi>c</mi><mn>2</mn></msup></mrow>
</math></p>
<p>A MathML block formula:</p>
<math display="block">
  <mi>E</mi><mo>=</mo><mrow><mi>m</mi><msup><mi>c</mi><mn>2</mn></msup></mrow>
</math>
<p><b>NOTE</b>: Don't forget to escape any Rimu macro invocations in the math
formulas (for example, <code>{i=0}</code> and <code>{2}</code> in the LaTeX formula).</p>
<p>See the <a href="http://docs.mathjax.org/en/latest/">latest MathJax
documentation</a> to learn how to use MathJax.</p>
<h2>Conditional inclusion</h2>
<p><em>Inclusion</em> macro invocations can be used to conditionally include and
exclude lines of source text:</p>
<ul><li>If-then-else logic:
<pre>{macro=} Included if macro is undefined or value is blank.
{macro!} Included if macro is defined and value not blank.</pre>
</li><li>Case statement logic:
<pre>{macro=one} Included if macro value is 'one'.
{macro=two} Included if macro value is 'two'.
{macro=\d+} Included if macro value is a number.</pre>
</li></ul><p><b>NOTE</b>: Rimu elements are recognized before macro expansion &mdash; you
cannot include macro invocations in element delimiters. For example,
this is a valid HTML block:</p>
<pre>&lt;script {highlightjs!} src="highlight.min.js"&gt;&lt;/script&gt;</pre>
<p>This is not and will be interpereted as a normal paragraph:</p>
<pre>{highlightjs!}&lt;script src="highlight.min.js"&gt;&lt;/script&gt;</pre>
<h2>Tables</h2>
<p>Create tables using the HTML table syntax (Rimu has no special syntax
for tables).</p>
<p>You can use Rimu markup in table cells, just remember that HTML blocks
must start at the left margin and end with a blank line.</p>
<p>The <code>rimuc</code> <code>--styled</code> option includes
<a href="http://getbootstrap.com/">Bootstrap</a> so you can use
<a href="http://getbootstrap.com/css/#tables">Bootstrap tables classes</a> to
create nicely formatted tables.</p>
<p>For example, this table:</p>
<table class="table table-bordered">
  <tbody>
    <tr>
<td style="width: 50%;">
<p class="text-info"><strong>Lorem ipsum dolor</strong>. Sit amet venenatis. Erat nulla arcu. Lorem luctus
sem. Mauris vitae ipsum. Donec dui ac ridiculus quisque proin.
Lobortis lacus vestibulum sem.</p>
<h5>Normal paragraph</h5>
<p>Lorem ipsum dolor. Sit <code>amet venenatis</code>. Erat nulla arcu. Lorem luctus
sem. <em>Mauris vitae</em> ipsum. Donec dui ac ridiculus <mark>quisque</mark> proin.
Lobortis lacus vestibulum sem.</p>
<h5>Indented paragraph</h5>
<pre>Neque a massa. Porttitor consectetuer commodo. Nunc nulla tempor
tempor enim ornare. Mi nam id. Ornare mauris tempor. Pede mauris
sed.  Scelerisque feugiat massa alias.</pre>
</td>
<td style="width: 50%;">
<ul><li>Lorem ipsum dolor sit amet dis quisque maecenas in tristique arcu
</li><li>lorem dolor fusce nec.
<ul><li>Sit pretium quisque in wisi lobortis.
</li><li>Ac curabitur elementum.
<ul><li>Platea ad diam arcu vitae fermentum.
<ol><li>Eu lorem nulla.
</li><li>In suspendisse at dapibus nostra est.
<ol><li>Montes adipiscing sodales.
</li></ol></li></ol></li><li>Pellentesque nibh sit.
</li></ul></li></ul></li><li>Augue et dui malesuada purus.
<pre>If a list item is followed by an indented paragraph the indented
paragraph is included in the list item.</pre>
</li></ul></td>
    </tr>
  </tbody>
</table>
<p>Was generated from this Rimu source:</p>
<pre><code>&lt;table class="table table-bordered"&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
&lt;td style="width: 50%;"&gt;

.text-info
*Lorem ipsum dolor*. Sit amet venenatis. Erat nulla arcu. Lorem luctus
sem. Mauris vitae ipsum. Donec dui ac ridiculus quisque proin.
Lobortis lacus vestibulum sem.

===== Normal paragraph
Lorem ipsum dolor. Sit `amet venenatis`. Erat nulla arcu. Lorem luctus
sem. _Mauris vitae_ ipsum. Donec dui ac ridiculus {mark|quisque} proin.
Lobortis lacus vestibulum sem.

===== Indented paragraph
  Neque a massa. Porttitor consectetuer commodo. Nunc nulla tempor
  tempor enim ornare. Mi nam id. Ornare mauris tempor. Pede mauris
  sed.  Scelerisque feugiat massa alias.

&lt;/td&gt;
&lt;td style="width: 50%;"&gt;

- Lorem ipsum dolor sit amet dis quisque maecenas in tristique arcu
- lorem dolor fusce nec.
  * Sit pretium quisque in wisi lobortis.
  * Ac curabitur elementum.
    ** Platea ad diam arcu vitae fermentum.
       1. Eu lorem nulla.
       2. In suspendisse at dapibus nostra est.
          .. Montes adipiscing sodales.
    ** Pellentesque nibh sit.

- Augue et dui malesuada purus.

  If a list item is followed by an indented paragraph the indented
  paragraph is included in the list item.

&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;</code></pre>
<h2>Macro meta-programming</h2>
<p>You can define macros which, when invoked, generate other macros. A
good example of this is the generation of document section headers,
links and table of contents entries from a section identifier and
title.</p>
<p>The following Rimu markup:</p>
<pre><code>// Macro to generate section link, header and TOC entry macros.
// $1 = section ID, $2 = section title.
{section-definition} = '
{$1} = '&lt;#$1|$2&gt;' \
{$1-header} = '&lt;&lt;#$1&gt;&gt;
== $2' \
{$1-toc} = '{$1} \' \
'
// Generate section macros.
{section-definition|section1|Section One}
{section-definition|section2|Section Two}

==== Table of Contents
{section1-toc}
{section2-toc}

// Section One section.
{section1-header}
Link to {section2}.

// Section Two section.
{section2-header}
Link to {section1}.</code></pre>
<p>Renders:</p>
<blockquote><h4>Table of Contents</h4>
<p><a href="#section1">Section One</a><br>
<a href="#section2">Section Two</a><br></p>
<div id="section1"></div>
<h2>Section One</h2>
<p>Link to <a href="#section2">Section Two</a>.</p>
<div id="section2"></div>
<h2>Section Two</h2>
<p>Link to <a href="#section1">Section One</a>.</p></blockquote>
<p>Note the use of the backslash character to continue macro definition
lines that end with a single-quote.</p>
<h2>Macro gotchas</h2>
<ul><li>Closing block delimiters must be explicit and cannot be sourced from
  a macro invocation (because Rimu elements are recognized before
  macro expansion).
</li><li>Macro invocations inside macro values are expanded when the macro
  is declared, not when it is invoked, you can defer evaluation until
  the macro is invoked by escaping the macro invocation. For example
  this Rimu markup:
<div><pre><code>{m1} = 'foo'
{m2} = '{m1} \{m1}'
{m2}

{m1} = 'bar'
{m2}</code></pre>
<p>Generates:</p>
<pre><code>&lt;p&gt;foo foo&lt;/p&gt;
&lt;p&gt;foo bar&lt;/p&gt;</code></pre></div>
</li></ul>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
