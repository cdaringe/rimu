<!DOCTYPE HTML>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width">
<title>Rimu Tips</title>
<link rel="stylesheet" href="http://yandex.st/highlightjs/7.3/styles/default.min.css">
<link href="https://fonts.googleapis.com/css?family=Arimo%7CCousine%7CTinos" rel="stylesheet">
<style>
  * {
    margin: 0;
    padding: 0;
  }
  body {
    font-size: 16px;
    line-height: 20px;
    color: #333333;
    background-color: white;
    font-family: Arimo, Arial, Helvetica, sans-serif;
  }
  h1, h2, h3, h4, h5, h6 {
    margin: 10px 0;
    color: #527bbd;
  }
  h1 { font-size: 2.2em; line-height: 40px;}
  h2 { font-size: 1.5em; }
  h3 { font-size: 1.2em; }
  h4 { font-size: 1.1em; }
  h5 { font-size: 1.0em; }
  h6 { font-size: 0.9em; }
  h2, h3, h4, h5, h6 {
    line-height: normal;
    margin-top: 1.0em;
    margin-bottom: 0.2em;
  }
  h2 {
    margin-top: 1.5em;
    border-bottom: 1px solid #dddddd;
  }
  img {
    max-width: 100%;
  }
  table {
    border-collapse: collapse;
    width: 100%;
  }
  td, th {
    text-align: left;
    vertical-align: top;
  }
  table.bordered > tbody > tr > th,
  table.bordered > tbody > tr > td {
    border: 1px solid #dddddd;
  }
  a, a:hover {
    color: #527bbd;
  }
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
  p, pre, li, dt, dd, blockquote p {
    line-height: 1.45;
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
  ul, ol {
    padding: 0;
    margin: 0 0 10px 25px;
  }
  dt {
    margin-bottom: 0;
    font-style: italic;
  }
  dd {
    margin-left: 1.0em;
    margin-top: 0;
  }
  blockquote {
    padding: 0 0 0 15px;
    border: none;
    border-left: 5px solid #eeeeee;
    font-family: Tinos, Georgia, serif;
    width: 80%;
    margin: 1.5em 0;
    color: #383838;
  }
  .cite {
    color: #777;
    padding: 5px 0;
  }
  .cite::before {
    content: "\2014 \2009";
  }
  code {
    font-family: Cousine, Consolas, "Andale Mono", Monaco, monospace;
    font-size: 90%;
    background-color: #f8f8f8;
  }
  pre {
    font-family: Cousine, Consolas, "Andale Mono", Monaco, monospace;
    line-height: normal;
    white-space: pre-wrap;
    word-break: break-all;
    background-color: #f8f8f8;
    border: 1px solid #dddddd;
    border-radius: 4px;
    padding: 6px;
  }
  .light-background {
    background-color: #f8f8f8;
    border: none;
  }
  *:not(pre) > code {
    white-space: nowrap;
  }
  .dl-horizontal > dd {
    margin-top: 1.0em;
  }
  pre > code {
    background-color: inherit;
    padding: 0;
  }
  pre span {
    opacity: 1 !important;
  }
  .verse {
    margin: 1.5em 20px;
  }
  div.verse p, p.verse {
    font-family: Tinos, Georgia, serif;
    white-space: pre;
    margin-top: 0.75em;
    margin-bottom: 0.75em;
  }
  .sidebar {
    border: 1px solid #dddddd;
    border-radius: 4px;
    background: #ffffee;
    padding: 10px;
    margin: 1.5em 0px;
  }
  div.sidebar *:first-child {
    margin-top: 0.2em;
  }
  .page-break {
    page-break-before: always;
  }
  .no-page-break {
    page-break-inside: avoid;
  }
  .align-left {
    text-align: left;
  }
  .align-center {
    text-align: center;
  }
  .align-right {
    text-align: right;
  }
  .line-breaks {
    white-space: pre;
  }
  .dl-horizontal:before, .dl-horizontal:after {
    display: table;
    content: "";
    line-height: 0;
  }
  .dl-horizontal:after {
    clear: both;
  }
  .dl-horizontal > dt {
    float: left;
    clear: left;
    text-align: right;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    text-align: left;
    margin-top: 1.0em;
    width: 25%;
  }
  .dl-horizontal > dd {
    margin-left: 25%;
    padding-left: 1.0em;
  }
  dl {
    counter-reset: dl-counter;
  }
  dl > dt {
    counter-increment: dl-counter;
  }
  ol {
    counter-reset: ol-counter;
  }
  ol > li {
    counter-increment: ol-counter;
  }
  ul {
    counter-reset: ul-counter;
  }
  ul > li {
    counter-increment: ul-counter;
  }
  .dl-counter:before {
    content: counter(dl-counter) " ";
  }
  .ol-counter:before {
    content: counter(ol-counter) " ";
  }
  .ul-counter:before {
    content: counter(ul-counter) " ";
  }
  .dl-numbered > dt:before {
    content: counter(dl-counter) ". ";
  }
  @media print {
    .no-print, .no-print * {
      display: none !important;
    }
  }
</style>
<style>
  #toc {
    padding-left: 1em;
  }
  #toc .h1 {
    font-size: 110%;
    font-weight: bold;
    margin-top: 0.5em;
    margin-bottom: 0.4em;
  }
  #toc .h2 {
    margin-top: 0.4em;
  }
  #toc .h3 {
    margin-left: 1.5em;
    font-size: 90%;
  }
  #toc div:nth-child(even) {
    background-color: #f8f8f8;
  }
  #auto-toc {
    width: 100%;
  }
</style>
<style>
  body {
    margin: 1em;
    max-width: 50em;
  }
</style>
<style>
  body {
    padding-left: 21em;
  }
  #toc {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    width: 18em;
    border-right: 1px solid #cccccc;
    overflow-y: auto;
    overflow-x: hidden;
    box-shadow: 0 0 3px rgba(0, 0, 0, 0.35);
  }
  @media print {
    body {
      padding-left: 1em;
    }
  }
  @media screen and (max-width: 700px) {
    body {
      padding-left: 0;
    }
    #toc {
      display: none !important;
    }
  }
</style>
<style>
  @media screen and (max-width: 700px) {
    body {
      font-size: 20px;
      margin: 5px;
    }
  }
</style>
</head>
<body>
<div id="article">

<style>
.edit-source {
  font-family: Cousine, Consolas, "Andale Mono", Monaco, monospace;
  font-size: 90%;
  line-height: normal;
  white-space: pre-wrap;
  word-break: break-all;
  margin: 0;
  border: none;
  outline: none;
  padding: 0.5em;
  width: 100%;
  background-color: #ffffee;
  box-shadow: 0 0 10px #9ecaed;
  box-sizing: border-box;
}
.edit-icon {
  text-decoration: underline;
  color: gray;
}
.example td {
  margin: 0;
  padding: 0;
}
.example-header {
  font-weight: bold;
  color: #527bbd;
  padding: 0.5em !important;
}
.example-source, .example-rendered {
  border: none;
  background-color: inherit;
  margin: 0;
  padding: 0.5em;
}
.example-source > code {
  padding: 0;
}
</style>
<script src="rimu.min.js"></script>
<script>
function editExample(name) {
  var source = document.getElementById(name + '-source');
  if (source.style.display === 'none') {
    return;
  }
  var edit = document.getElementById(name + '-edit');
  edit.value = source.textContent;
  edit.style.height = (edit.parentNode.offsetHeight - 1) + 'px';
  edit.style.display = 'block';
  source.style.display = 'none';
}
function updateExample(name) {
  var edit = document.getElementById(name + '-edit');
  var rendered = document.getElementById(name + '-rendered');
  rendered.innerHTML = Rimu.render(edit.value);
  edit.style.height = edit.parentNode.offsetHeight + 'px';
}
</script>
<div id="toc" class="no-print">
  <h2 style="font-size:1.2em; margin-top:1.0em">Links</h2>
  <div class="h2"><a href="index.html">Rimu Home</a></div>
  <div class="h2"><a href="rimuplayground.html">Rimu Playground</a></div>
  <div class="h2"><a href="reference.html">Rimu Reference</a></div>
  <div class="h2"><a href="tips.html">Rimu Tips</a></div>
  <div class="h2"><a href="https://github.com/srackham/rimu">Github</a></div>
  <div class="h2"><a href="https://npmjs.org/package/rimu">npm</a></div>
  <h2 style="font-size:1.2em; margin-top:1.0em">Table of Contents</h2>
  <div id="auto-toc"></div>
</div>
<h1>Rimu Tips</h1>
<p><b>TIP</b>: Click the <em>Edit icon</em> <span class="edit-icon">&#x270e;</span> in the examples below to enable
live example editing of the Rimu source.</p>
<h2>HTML is valid Rimu</h2>
<p>You are free to mix any valid HTML into a Rimu document &mdash; no
special syntax or relearning  is required (in this sense Rimu can be
thought of as an HTML superset). Just remember that included HTML is
only processed if <code>safeMode</code> is zero.</p>
<h2>Converting Rimu to PDF</h2>
<p>First convert Rimu markup to HTML using the <a href="reference.html#rimuc-command">rimuc</a> tool and then
convert the HTML to PDF.  Here are a few options for converting HTML
to PDF:</p>
<ol><li>Google's Chrome web browser has an option to print HTML to a PDF
  file, other browsers have PDF add-ons that perform the same
  function, this does a good job especially if you use the <a href="reference.html#rimuc-command">rimuc</a>
  <code>--styled</code> option.
</li><li>Use an HTML to PDF conversion program such as
  <a href="http://www.htmldoc.org/">HTMLDOC</a>.
</li></ol><h2>Extend Rimu with Macros</h2>
<p>Macros provide a simple, consistent mechanism for extending the Rimu
markup vocabulary.</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header" style="width:10%;">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('macros-example')">&#x270e;</span>
Rimu source</td>
<td>
<pre id="macros-example-source" class="example-source no-highlight"><code>// Define some macros.
{info} = '&lt;span style="color:white;
                       background-color:#006699;
                       padding:2px 4px;
                       border-radius:3px;
                       font-weight:bold;"&gt;$1&lt;/span&gt;'
{heads-up} = '{info|Heads up!}'
{note} = '{info|Note} &lt;mark&gt;$1&lt;/mark&gt;'
{playground} = '[Rimu Playground](http://srackham.github.io/rimu/rimuplayground.html)'
{sidebar} = '#### $1
."padding-left: 10px; border-left: 4px solid silver; margin-bottom: 1em;"'

// Use the macros.
{sidebar|Fun with Macros}
..
{heads-up} See the {playground} for documentation and hands-on
experimentation.

{note|This document is not yet finished.}
..</code></pre>
<textarea id="macros-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('macros-example')"></textarea>
</td>
</tr>
<tr><td class="example-header" style="width:10%;">Rendered HTML</td>
<td>
<div id="macros-example-rendered" class="example-rendered">
<h4>Fun with Macros</h4>
<div style="padding-left: 10px; border-left: 4px solid silver; margin-bottom: 1em;"><p><span style="color:white;
                       background-color:#006699;
                       padding:2px 4px;
                       border-radius:3px;
                       font-weight:bold;">Heads up!</span> See the <a href="http://srackham.github.io/rimu/rimuplayground.html">Rimu Playground</a> for documentation and hands-on
experimentation.</p>
<p><span style="color:white;
                       background-color:#006699;
                       padding:2px 4px;
                       border-radius:3px;
                       font-weight:bold;">Note</span> <mark>This document is not yet finished.</mark></p></div>
</div>
</td></tr></table>
<ul><li>The <code>{sidebar}</code> macro shows how you can inject CSS styles into a
  <em>Division Block</em> (you could also use use <a href="#scoped-css">CSS</a> to
  style the output).
</li><li>Note how macro definitions can span multiple lines and can contain
  any valid Rimu markup (including HTML and blank lines).
</li><li><a href="https://github.com/srackham/rimu/blob/master/doc/tips.rmu">This document</a>
  makes extensive use of Rimu macros.
</li></ul><h2>Intra-document Links</h2>
<p>To link to another place within a document: Create an ID for the
element you want to link to (using the Rimu <em>Block Attribute</em> element)
then create a link to it using a fragment identifier URL.</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('document-links-example')">&#x270e;</span>
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="document-links-example-source" class="example-source no-highlight"><code>.#link-target
This paragraph has ID `link-target`.

&lt;#link-target|This link&gt; takes you to
the above paragraph.

// Markdown compatible syntax.
So does [this link](#link-target).</code></pre>
<textarea id="document-links-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('document-links-example')"></textarea>
</td>
<td style="width:50%;">
<div id="document-links-example-rendered" class="example-rendered">
<p id="link-target">This paragraph has ID <code>link-target</code>.</p>
<p><a href="#link-target">This link</a> takes you to
the above paragraph.</p>
<p>So does <a href="#link-target">this link</a>.</p>
</div>
</td></tr></table>
<p><b>NOTE</b>: The <a href="reference.html#rimuc-command">rimuc</a> <code>--styled</code> option
automatically synthesises <code>id</code> attributes for top level <code>#</code>, <code>##</code> and
<code>###</code> header elements that do not already have an <code>id</code>.</p>
<h2 id="syntax-highlighting">Source code syntax highlighting</h2>
<p>The <a href="reference.html#rimuc-command">rimuc</a> command can highlight code in Rimu <em>Code Blocks</em> and
<em>Indented Paragraphs</em> using the
<a href="https://github.com/isagalaev/highlight.js">Highlight.js</a> syntax
highlighter.  To include <em>Highlight.js</em> support use the <a href="reference.html#rimuc-command">rimuc</a>
command <code>--highlightjs</code> option with the <code>--styled</code> option.</p>
<p>Set the language you want to highlight by injecting the language CSS
class name into the code block.  Here are two examples, the first uses
Github Flavored Markdown style syntax, the second uses Rimu's <em>Block
Attributes</em> element:</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="highlightjs-example-source" class="example-source no-highlight"><code>Some JavaScript code:

``` javascript
if (message) {
  console.error('Error: ' + message);
}
```

Some Python code:

.python
``
x = 1
if x == 1:
    print "x is 1."
``</code></pre>
<textarea id="highlightjs-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('highlightjs-example')"></textarea>
</td>
<td style="width:50%;">
<div id="highlightjs-example-rendered" class="example-rendered">
<p>Some JavaScript code:</p>
<pre class="javascript no-highlight"><code>if (message) {
  console.error('Error: ' + message);
}</code></pre>
<p>Some Python code:</p>
<pre class="python no-highlight"><code>x = 1
if x == 1:
    print "x is 1."</code></pre>
</div>
</td></tr></table>
<p>Set the <code>no-highlight</code> class to disable syntax highlighting for a code
block.  Adding the <code>no-highlight</code> class to all code blocks using
<em>Delimited Block Definitions</em> turns off highlighting unless the
language class is explicitly set. The <a href="https://github.com/srackham/rimu/blob/master/src/examples/example-rimurc.rmu">example .rimurc
file</a> does this with these custom definitions:</p>
<pre class="no-highlight"><code>|code| = '&lt;pre class="no-highlight"&gt;&lt;code&gt;|&lt;/code&gt;&lt;/pre&gt;'
|indented| = '&lt;pre class="no-highlight"&gt;&lt;code&gt;|&lt;/code&gt;&lt;/pre&gt;'</code></pre>
<h2 id="markdown-compatible">Syntax shared with Markdown</h2>
<p>The following subset of <em>Rimu</em> elements is compatible with Markdown:</p>
<dl><dt>Headers</dt><dd> Headers using <code>#</code> character header prefixes.
</dd><dt>Code blocks</dt><dd>
<ul><li>Indented paragraphs (at least four spaces) render like Markdown code
  blocks.
</li><li>Rimu Fenced Code blocks with three or more backticks are compatible with
  <a href="https://help.github.com/articles/github-flavored-markdown/">GitHub Flavored Markdown</a>
  <em>Fenced Blocks</em>.
</li></ul></dd><dt>Quote paragraphs</dt><dd> Paragraphs starting with a <code>&gt;</code> character are
rendered like Markdown Blockquotes.
</dd><dt>Text formatting</dt><dd>
<ul><li><code>_emphasis_</code>, <code>*emphasis*</code>, <code>__bold__</code>, <code>**bold**</code>,
  <code>`code`</code> , <code>``code``</code> quoting.
</li><li><code>~~strikethrough~~</code> quotes (GitHub Flavored Markdown behaviour).
</li><li>Underscores within words rendered verbatim and are not treated as
  underscore emphasis quotes (Github Flavored Markdown behaviour).
</li></ul></dd><dt>Lists</dt><dd>
<ul><li>Bullet lists with <code>-</code>, <code>+</code>  and <code>*</code> prefixes.
</li><li>Numbered lists with explicit numbering.
</li></ul></dd><dt>URLs and Email addresses</dt><dd> <code>[caption](url)</code>, <code>&lt;url&gt;</code> and <code>&lt;email&gt;</code>
syntaxes plus Github Flavored Markdown <em>URL autolinking</em>.
</dd><dt>Images</dt><dd> <code>![alt](url)</code> syntax.
</dd></dl><p>The Rimu <em>README</em> uses this subset for compatibility with <em>GitHub</em> and
<em>npmjs.org</em> README formats.</p>
<h2 id="rimuc-html">Processing HTML and Markdown with the <code>rimuc</code> command</h2>
<p><a href="reference.html#rimuc-command">rimuc</a> passes the contents of input files with a <code>.html</code> extension
directly to the output.  This allows you to generate styled HTML5
documents from raw HTML files (HTML with no <code>&lt;html&gt;</code>, <code>&lt;head&gt;</code> or
<code>&lt;body&gt;</code> tags), or from non Rimu compatible Markdown files, using the
<a href="reference.html#rimuc-command">rimuc</a> <code>--styled</code> option. Examples:</p>
<dl><dt>Raw HTML file</dt><dd> Convert <code>mydoc.html</code> to styled HTML5 document with
table of contents:
<pre class="no-highlight"><code>rimuc --styled --dropdown-toc mydoc.html</code></pre>
</dd><dt>Arbitrary Markdown file</dt><dd> Convert <code>mydoc.md</code> to styled HTML5 document
after first converting it to raw HTML with <code>markdown</code>:
<pre class="no-highlight"><code>markdown mydoc.md &gt; mydoc.html
rimuc --styled mydoc.html</code></pre>
</dd><dt>Rimu compatible Markdown file</dt><dd> Convert <code>mydoc.md</code> to styled HTML5
document:
<pre class="no-highlight"><code>rimuc --styled mydoc.md</code></pre>
</dd></dl><h2>Escaping Rimu syntax</h2>
<p>If you have text that you don't want interpreted as a Rimu
element then you can render it literally (escape it) by prefixing the
element with a backslash character.</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('escaped-elements-example')">&#x270e;</span>
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="escaped-elements-example-source" class="example-source no-highlight"><code>\_escaped quote_

**escaped closing\** quote**

``backticks in `code quote```

\# Escaped header.</code></pre>
<textarea id="escaped-elements-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('escaped-elements-example')"></textarea>
</td>
<td style="width:50%;">
<div id="escaped-elements-example-rendered" class="example-rendered">
<p>_escaped quote_</p>
<p><strong>escaped closing** quote</strong></p>
<p><code>backticks in `code quote`</code></p>
<p># Escaped header.</p>
</div>
</td></tr></table>
<p><b>NOTE</b>: The text inside <em>code</em> quotes is always rendered verbatim &mdash; to
include backtick characters in code quotes use double-backtick quotes.</p>
<h2>Passing macro values into Rimu documents</h2>
<p>You can do this by prepending text containing macro definitions to
Rimu source before rendering the source. The <a href="reference.html#rimuc-command">rimuc</a> command has a
<code>--prepend</code> option that can be used to do this.</p>
<p>Alternatively you could also put macro definitions in a
separate file and specify it as the first Rimu source file in the
<a href="reference.html#rimuc-command">rimuc</a> command.</p>
<p>The following example sets the <a href="reference.html#rimuc-command">rimuc</a> <code>--title</code> macro value, this
sets the HTML <em>title</em> in the <code>kotlin-notes.html</code> output document:</p>
<pre class="no-highlight"><code>rimuc --styled --prepend "{--title}='Kotlin Notes'" kotlin-notes.rmu</code></pre>
<p><a href="reference.html#rimuc-command">rimuc</a> has a <code>--title</code> shortcut comand-line option for this common
use-case:</p>
<pre class="no-highlight"><code>rimuc --styled --title "Kotlin Notes" kotlin-notes.rmu</code></pre>
<p>Other macro shortcut options can be found in the <a href="reference.html#rimuc-command">rimuc</a>
documentation.</p>
<h2>The Rimu markup looks correct but the generated HTML is wrong</h2>
<p>Using an editor with Rimu syntax highlighting support (see previous
topic) makes it much easier to spot syntax errors.  Rimu includes a
Vim editor syntax highlighter, see the <a href="http://srackham.github.io/rimu/reference.html#vim-syntax-file">Vim syntax
file</a>
section in the <a href="http://srackham.github.io/rimu/reference.html">Rimu
Reference</a> for details.</p>
<h2>Extending the Vim syntax highlighter</h2>
<p>If you've added custom replacements and quotes you can highlight them
in Vim by creating a custom <code>~/.vim/after/syntax/rimu.vim</code> syntax
file (Vim loads files from the <code>after</code> directory after loading normal
syntax files).  The distributed example
<a href="https://github.com/srackham/rimu/blob/master/src/examples/example-rimurc.vim">~/.vim/after/syntax/rimu.vim</a>
syntax file highlights custom syntax definitions from the <a href="https://github.com/srackham/rimu/blob/master/src/examples/example-rimurc.rmu">example
.rimurc file</a>.</p>
<h2>Render contiguous Indented paragraphs with a single element</h2>
<p>When you have multiple Indented paragraphs separated by blank lines
the usual expectation is that they will be contained in a single
listing &mdash; to achieve this separate the paragraphs with lines
containing one or more space characters.</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('joined-paragraphs-example')">&#x270e;</span>
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="joined-paragraphs-example-source" class="example-source no-highlight"><code>#### Separator line is blank

  Neque a massa. Porttitor
  consectetuer commodo.

  Neque a massa. Porttitor
  consectetuer commodo.


#### Separator line with spaces

  Neque a massa. Porttitor
  consectetuer commodo.
  
  Neque a massa. Porttitor
  consectetuer commodo.


#### Use a code block instead

```
Neque a massa. Porttitor
consectetuer commodo.

Neque a massa. Porttitor
consectetuer commodo.
```</code></pre>
<textarea id="joined-paragraphs-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('joined-paragraphs-example')"></textarea>
</td>
<td style="width:50%;">
<div id="joined-paragraphs-example-rendered" class="example-rendered">
<h4>Separator line is blank</h4>
<pre class="no-highlight"><code>Neque a massa. Porttitor
consectetuer commodo.</code></pre>
<pre class="no-highlight"><code>Neque a massa. Porttitor
consectetuer commodo.</code></pre>
<h4>Separator line with spaces</h4>
<pre class="no-highlight"><code>Neque a massa. Porttitor
consectetuer commodo.
 
Neque a massa. Porttitor
consectetuer commodo.</code></pre>
<h4>Use a code block instead</h4>
<pre class="no-highlight"><code>Neque a massa. Porttitor
consectetuer commodo.

Neque a massa. Porttitor
consectetuer commodo.</code></pre>
</div>
</td></tr></table>
<h2>Entering non-keyboard characters</h2>
<p>Characters that are unavailable on your keyboard can be entered as 
<a href="http://dev.w3.org/html5/html-author/charref">HTML character entities</a>
e.g. enter <code>&amp;micro;</code> to display &micro;. The 
<a href="#example-rimurc">example .rimurc file</a>
includes replacements for common use-cases such as em dash, ellipsis and
quotation characters.</p>
<h2 id="defs-warning">Use Replacement and Quote definitions sparingly</h2>
<p>Adding new Replacement and Quote definitions changes the Rimu syntax
which can produce unexpected results. It can also make your Rimu
source non-portable and less readable.</p>
<h2 id="example-rimurc">Example .rimurc file</h2>
<p>The Rimu distribution includes an <a href="https://github.com/srackham/rimu/blob/master/src/examples/example-rimurc.rmu">example .rimurc
file</a> containing useful macros, quotes and
replacement definitions.</p>
<p>It is important to note that these niceties have been defined in
Rimu Markup &mdash; Rimu has been extended using Rimu. No plugins
or special configuration file syntax were necessary.</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="rimurc-examples-source" class="example-source no-highlight"><code>Turn &lt;- left then right -&gt;

Copyright (C) 2015 -- trademarked(TM).

"Left and right double-quotes".

The 3{sup|rd} H{sub|2}O molecule...

IMPORTANT: Admonition.

TODO 10 examples +-2</code></pre>
<textarea id="rimurc-examples-edit" class="edit-source" style="display:none" onkeyup="updateExample('rimurc-examples')"></textarea>
</td>
<td style="width:50%;">
<div id="rimurc-examples-rendered" class="example-rendered">
<p>Turn &leftarrow; left then right &rightarrow;</p>
<p>Copyright &copy; 2015 &mdash; trademarked&trade;.</p>
<p>&ldquo;Left and right double-quotes&rdquo;.</p>
<p>The 3<sup>rd</sup> H<sub>2</sub>O molecule&hellip;</p>
<p><b>IMPORTANT</b>: Admonition.</p>
<p><b style="color: red; background-color: yellow;">TODO</b> 10 examples &plusmn;2</p>
</div>
</td></tr></table>
<h2 id="scoped-css">Custom styling</h2>
<div class="sidebar"><h4>Scoped styling removed from HTML5 spec 12-May-2016</h4>
<p>The <code>scoped</code> attribute was <a href="https://github.com/whatwg/html/commit/c2a3b2a2e3db49c14b486a5e99acf7d10cfe8443">removed from the HTML5 spec in May
2016</a>
&ldquo;due to lack of implementer interest&rdquo;.  Consequently the examples
below are, strictly speaking, illegal.  This is because the <code>style</code>
element can now only reside inside the <code>head</code> element.  In practice
however, all popular browsers allow <code>style</code> elements outside the
<code>head</code> element (the styles from these elements are applied globally
and the <code>scoped</code> attribute is ignored).</p>
<p>The examples below generate <code>style</code> elements located outside the
<code>head</code> element and although they work perfectly they do not pass
HTML5 validator checks. Prior to Rimu version 9 these examples
used the <code>style</code> element <code>scoped</code> attribute.</p>
<p>See also:</p>
<ul><li><a href="http://stackoverflow.com/questions/28633038/what-is-the-current-state-of-the-scoped-attribute-for-the-style-element-in-htm">What is the current state of the “scoped” attribute for the style
  element in
  HTML5?</a>.
</li><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/style">MDN
  &lt;style&gt;</a>.
</li><li><a href="http://stackoverflow.com/a/16844668/1136455">Using &lt;style&gt; tags in the &lt;body&gt; with other
  HTML</a>.
</li></ul></div>
<p>You can include custom CSS styles in the body of a Rimu document using
an HTML <code>style</code> element. Here are three use-cases:</p>
<ol><li>Change existing styling. The following example changes the color of
  all headers to red:
<pre class="no-highlight"><code>&lt;style&gt;
  h1, h2, h3, h4, h5, h6 {
    color: red;
  }
&lt;/style&gt;</code></pre>
</li><li>Add a new block style. The following example puts a green border
  around blocks with the <code>green-border</code> class:
<pre class="no-highlight"><code>&lt;style&gt;
  .green-border {
    border: 5px solid green;
  }
&lt;/style&gt;

.green-border
Green is the color of envy.</code></pre>
</li><li>Create new <a href="#themes">themes</a> and tweak existing themes.
</li></ol><p><b>IMPORTANT</b>: The <code>style</code> element must not contain any blank lines because
Rimu HTML block elements are terminated with a blank line</p>
<h2>Themes</h2>
<p>A <em>theme</em> is the overall typographical style of the rendered HTML
document.  You can tailor the theme using <a href="#scoped-css">custom CSS style
elements</a>.</p>
<p>The <a href="reference.html#rimuc-command">rimuc</a> command supports named themes with the <code>--theme</code> option,
all this does is set the <code>--theme</code> macro value which is then used to
<a href="#conditional-inclusion">conditionally include</a> HTML <code>style</code> elements.</p>
<p>The following example styles the output using the built-in <em>graystone</em>
theme:</p>
<pre class="no-highlight"><code>rimuc --styled --theme graystone document.rmu</code></pre>
<p>You can create your own themes or tweak existing themes by
<a href="#conditional-inclusion">conditionally including</a> HTML <code>style</code>
elements.  Here is an example theme named <em>redheads</em>:</p>
<pre class="no-highlight"><code>{--theme!.*\bredheads\b.*}.+skip
&lt;style&gt;
  h1, h2, h3, h4, h5, h6 {
    color: red;
  }
&lt;/style&gt;</code></pre>
<p>The HTML <code>style</code> element will be included when the <code>--theme</code> macro
value includes the word <code>redheads</code>, for example:</p>
<pre class="no-highlight"><code>rimuc --styled --theme redheads document.rmu</code></pre>
<p>You can combine themes by specifying more than one theme, for example:</p>
<pre class="no-highlight"><code>rimuc --styled --theme "graystone redheads" document.rmu</code></pre>
<p><b>NOTE</b>: If you specify multiple themes their CSS styles will casacade in
the order they are processed in the Rimu source documents.</p>
<h2>Verse and sidebar styles</h2>
<p>The <a href="reference.html#rimuc-command">rimuc</a> command <code>--styled</code> option includes <em>verse</em> and <em>sidebar</em>
CSS styles for poetry and highlighted passages of text.</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('verse-and-sidebar-example')">&#x270e;</span>
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="verse-and-sidebar-example-source" class="example-source no-highlight"><code>Verse styled paragraph:

.verse
Neque a massa.
Porttitor consectetuer commodo.

Verse styled Division Block:

.verse
..
#### Lorum Ipsum
Neque a massa.
Porttitor consectetuer commodo.

Nunc mauris tempor.
Pede mauris sed.
Scelerisque feugiat massa alias.
..

Sidebar styled paragraph:

.sidebar
Neque a massa.
Porttitor consectetuer commodo.

Sidebar styled Division Block:

.sidebar
..
#### Lorum Ipsum
Neque a massa.
Porttitor consectetuer commodo.

Nunc mauris tempor.
Pede mauris sed.
Scelerisque feugiat massa alias.
..</code></pre>
<textarea id="verse-and-sidebar-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('verse-and-sidebar-example')"></textarea>
</td>
<td style="width:50%;">
<div id="verse-and-sidebar-example-rendered" class="example-rendered">
<p>Verse styled paragraph:</p>
<p class="verse">Neque a massa.
Porttitor consectetuer commodo.</p>
<p>Verse styled Division Block:</p>
<div class="verse"><h4>Lorum Ipsum</h4>
<p>Neque a massa.
Porttitor consectetuer commodo.</p>
<p>Nunc mauris tempor.
Pede mauris sed.
Scelerisque feugiat massa alias.</p></div>
<p>Sidebar styled paragraph:</p>
<p class="sidebar">Neque a massa.
Porttitor consectetuer commodo.</p>
<p>Sidebar styled Division Block:</p>
<div class="sidebar"><h4>Lorum Ipsum</h4>
<p>Neque a massa.
Porttitor consectetuer commodo.</p>
<p>Nunc mauris tempor.
Pede mauris sed.
Scelerisque feugiat massa alias.</p></div>
</div>
</td></tr></table>
<h2>Using Macro, Replacement and Quote definitions in Safe Mode</h2>
<p><em>Macro</em>, <em>Replacement</em> and <em>Quote</em> definitions are not processed in
Safe Mode. To apply Macro, Replacement or Quote definitions to Rimu
markup that is processed in Safe Mode you need to load the definitions
with a separate API call, for example:</p>
<pre class="javascript no-highlight"><code>Rimu.render(trusted_rimu_definitions, {safeMode: 0});
var html = Rimu.render(untrusted_rimu_markup, {safeMode: 5});</code></pre>
<h2>Mathematical formulae</h2>
<p>The <a href="reference.html#rimuc-command">rimuc</a> command supports <a href="http://www.mathjax.org/">MathJax</a> LaTeX
and MathML mathematical formulas.  To include <em>MathJax</em> support use
the <a href="reference.html#rimuc-command">rimuc</a> command <code>--mathjax</code> option with the <code>--styled</code> option.</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header" style="width:10%;">
Rimu source</td>
<td>
<pre id="mathjax-example-source" class="example-source no-highlight"><code>.-macros
A LaTeX inline formula: \(\sum_{i=0}^n i^2 = \frac{n^2+n}m{2}\)

A LaTeX block formula:

.-macros
\[\sum_{i=0}^n i^2 = \frac{n^2+n}m{2}\]

A MathML inline formula:
&lt;math&gt;
  &lt;mi&gt;E&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;
&lt;/math&gt;

A MathML block formula:

&lt;math display="block"&gt;
  &lt;mi&gt;E&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;
&lt;/math&gt;</code></pre>
<textarea id="mathjax-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('mathjax-example')"></textarea>
</td>
</tr>
<tr><td class="example-header" style="width:10%;">Rendered HTML</td>
<td>
<div id="mathjax-example-rendered" class="example-rendered">
<p>A LaTeX inline formula: \(\sum_{i=0}^n i^2 = \frac{n^2+n}m{2}\)</p>
<p>A LaTeX block formula:</p>
<p>\[\sum_{i=0}^n i^2 = \frac{n^2+n}m{2}\]</p>
<p>A MathML inline formula:
<math>
  <mi>E</mi><mo>=</mo><mrow><mi>m</mi><msup><mi>c</mi><mn>2</mn></msup></mrow>
</math></p>
<p>A MathML block formula:</p>
<math display="block">
  <mi>E</mi><mo>=</mo><mrow><mi>m</mi><msup><mi>c</mi><mn>2</mn></msup></mrow>
</math>
</div>
</td></tr></table>
<ul><li>Macro expansion has been disabled in LaTeX formulas to stop <code>{i=0}</code>
  and <code>{2}</code> in the LaTeX formualae from being mistaken for Rimu macro
  invocations.
</li></ul><p>See the <a href="http://docs.mathjax.org/en/latest/">latest MathJax
documentation</a> to learn how to use
MathJax.</p>
<h2 id="conditional-inclusion">Conditional Inclusion</h2>
<p>Macro invocations can be used to conditionally include Rimu source
text:</p>
<pre class="no-highlight"><code>// Include script if `foo` value is non-blank.
{foo!}&lt;script src="foo-min.js"&gt;&lt;/script&gt;

// Include paragraph if `foo` is blank.
{foo=}.+skip
Macro `foo`
must be blank.

// Conditional inclusion of arbitrary blocks of Rimu source.
// Assign `x` and `y` macro values and include some CSS if `foo`
// and `bar` are non-blank.
// Works because a Division Block does not emit div tags if they
// have no HTML attributes.
{foo=}.+skip
{bar=}.+skip
..
{x} = '42'
{y} = '24'
&lt;style&gt;
  * { margin: 0; padding: 0; }
&lt;/style&gt;
..

// Inline examples.
This line is included {foo=} if foo value is blank.
This line is included {foo!} if foo value is not blank.
This line is included {foo=one} if foo value is 'one'.
This line is included {foo=two} if foo value is 'two'.
This line is included {foo!\d+} if foo value is not a number.

// Use parametrized macros to exclude arbitrary inline text.
{foo} = ''
Mauris vitae {foo|This text is excluded}

{foo} = '$1'
Mauris vitae {foo|This text is included}</code></pre>
<h2>Tables</h2>
<p>Create tables using <em>Block HTML elements</em> (Rimu has no dedicated
syntax for tables <a href="#use-macros-to-create-tables">but you can use macros to simplify table
creation</a>).</p>
<p><b>NOTE</b>: HTML blocks must start at the left margin and end with a blank
line.</p>
<p>The <a href="reference.html#rimuc-command">rimuc</a> <code>--styled</code> option includes the <code>bordered</code> CSS class for
styling bordered tables.</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header" style="width:10%;">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('tables-example')">&#x270e;</span>
Rimu source</td>
<td>
<pre id="tables-example-source" class="example-source no-highlight"><code>&lt;table class="bordered"&gt;&lt;tr&gt;
&lt;td style="width: 50%; padding: 6px;"&gt;

.text-info
**Lorem ipsum dolor**. Sit amet venenatis. Erat nulla arcu. Lorem luctus
sem. Mauris vitae ipsum. Donec dui ac ridiculus quisque proin.
Lobortis lacus vestibulum sem.

##### Normal paragraph
Lorem ipsum dolor. Sit `amet venenatis`. Erat nulla arcu. Lorem luctus
sem. _Mauris vitae_ ipsum. Donec dui ac ridiculus {mark|quisque} proin.
Lobortis lacus vestibulum sem.

##### Indented paragraph
  Neque a massa. Porttitor consectetuer commodo. Nunc nulla tempor
  tempor enim ornare. Mi nam id. Ornare mauris tempor. Pede mauris
  sed.  Scelerisque feugiat massa alias.

&lt;/td&gt;
&lt;td style="width: 50%; padding: 6px;"&gt;

- Lorem ipsum dolor sit amet dis quisque maecenas in tristique arcu
- lorem dolor fusce nec.
  * Sit pretium quisque in wisi lobortis.
  * Ac curabitur elementum.
    ** Platea ad diam arcu vitae fermentum.
       1. Eu lorem nulla.
       2. In suspendisse at dapibus nostra est.
          .. Montes adipiscing sodales.
    ** Pellentesque nibh sit.

- Augue et dui malesuada purus.

  If a list item is followed
  by an indented paragraph the
  indented paragraph is
  included in the list item.

&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;</code></pre>
<textarea id="tables-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('tables-example')"></textarea>
</td>
</tr>
<tr><td class="example-header" style="width:10%;">Rendered HTML</td>
<td>
<div id="tables-example-rendered" class="example-rendered">
<table class="bordered"><tr>
<td style="width: 50%; padding: 6px;">
<p class="text-info"><strong>Lorem ipsum dolor</strong>. Sit amet venenatis. Erat nulla arcu. Lorem luctus
sem. Mauris vitae ipsum. Donec dui ac ridiculus quisque proin.
Lobortis lacus vestibulum sem.</p>
<h5>Normal paragraph</h5>
<p>Lorem ipsum dolor. Sit <code>amet venenatis</code>. Erat nulla arcu. Lorem luctus
sem. <em>Mauris vitae</em> ipsum. Donec dui ac ridiculus <mark>quisque</mark> proin.
Lobortis lacus vestibulum sem.</p>
<h5>Indented paragraph</h5>
<pre class="no-highlight"><code>Neque a massa. Porttitor consectetuer commodo. Nunc nulla tempor
tempor enim ornare. Mi nam id. Ornare mauris tempor. Pede mauris
sed.  Scelerisque feugiat massa alias.</code></pre>
</td>
<td style="width: 50%; padding: 6px;">
<ul><li>Lorem ipsum dolor sit amet dis quisque maecenas in tristique arcu
</li><li>lorem dolor fusce nec.
<ul><li>Sit pretium quisque in wisi lobortis.
</li><li>Ac curabitur elementum.
<ul><li>Platea ad diam arcu vitae fermentum.
<ol><li>Eu lorem nulla.
</li><li>In suspendisse at dapibus nostra est.
<ol><li>Montes adipiscing sodales.
</li></ol></li></ol></li><li>Pellentesque nibh sit.
</li></ul></li></ul></li><li>Augue et dui malesuada purus.
<pre class="no-highlight"><code>If a list item is followed
by an indented paragraph the
indented paragraph is
included in the list item.</code></pre>
</li></ul></td>
</tr></table>
</div>
</td></tr></table>
<p>The use of inline HTML for tables instead of a Rimu-specific table
syntax was a deliberate design decision:</p>
<ul><li>A large number of formatting options (e.g. for headers and footers;
  cell widths, heights, alignment and spans) are required to
  accommodate all but the simplest of tables. This makes for a complex
  and noisy syntax &mdash; precisely what we're trying to avoid.
</li><li>Coming up with a syntax that is both recognizably tabular and easily
  written is difficult &mdash; imagine trying to write the above example in
  a way that maintains the side-by-side cell layout.
</li><li>At first blush tables come across as a hugely useful feature, but
  most documentation makes surprising little use of tables.
</li></ul><p>See also <a href="#use-macros-to-create-tables">Use macros to create tables</a>.</p>
<h2 class="use-macros-to-create-tables">Use macros to create tables</h2>
<p>Creating tables with raw HTML is repetitive, time consuming and
difficult to read.</p>
<p>Parametrized macros can be used to generate row oriented tables:</p>
<h4>Row oriented tables</h4>
<table class="example bordered">
<tr>
<td class="example-header" style="width:10%;">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('table-macro-example')">&#x270e;</span>
Rimu source</td>
<td>
<pre id="table-macro-example-source" class="example-source no-highlight"><code>{person} = '&lt;table&gt;&lt;tr&gt;&lt;td style="width:15em"&gt;$$1&lt;/td&gt;
&lt;td style="width:5em"&gt;$$2&lt;/td&gt;
&lt;td&gt;$$3&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
'

.bordered "color:#527bbd;"
{person| **Name**    | **Age**| **Gender**}
{person| Joe Bloggs  | 25     | Male}
{person| _Jim Smith_ | 31     | Male}
."color:red;"
{person| Peg Legge   | **30** | Female}
</code></pre>
<textarea id="table-macro-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('table-macro-example')"></textarea>
</td>
</tr>
<tr><td class="example-header" style="width:10%;">Rendered HTML</td>
<td>
<div id="table-macro-example-rendered" class="example-rendered">
<table class="bordered" style="color:#527bbd;"><tr><td style="width:15em"> <strong>Name</strong>    </td>
<td style="width:5em"> <strong>Age</strong></td>
<td> <strong>Gender</strong></td></tr></table>
<table><tr><td style="width:15em"> Joe Bloggs  </td>
<td style="width:5em"> 25     </td>
<td> Male</td></tr></table>
<table><tr><td style="width:15em"> <em>Jim Smith</em> </td>
<td style="width:5em"> 31     </td>
<td> Male</td></tr></table>
<table style="color:red;"><tr><td style="width:15em"> Peg Legge   </td>
<td style="width:5em"> <strong>30</strong> </td>
<td> Female</td></tr></table>
</div>
</td></tr></table>
<ul><li><em>Block HTML elements</em> must be terminated with a blank line.
</li><li>Double-dollar macro parameters are necessary because text formatting
  is not expanded and special characters are not escaped inside <a href="reference.html#block-html-elements">Block
  HTML elements</a>.
</li></ul><p>Macros can also be used to simplify columnar text layouts:</p>
<h4>Columnar text layouts</h4>
<table class="example bordered">
<tr>
<td class="example-header" style="width:10%;">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('columnar-text-example')">&#x270e;</span>
Rimu source</td>
<td>
<pre id="columnar-text-example-source" class="example-source no-highlight"><code>// Each macro generates an HTML block which together generate a single table.
{column1} = '&lt;table&gt;&lt;tr&gt;&lt;td style="width:33%;padding:0.5em;"&gt;
'
{column2} = '&lt;/td&gt;&lt;td style="width:33%;padding:0.5em;"&gt;
'
{column3} = '&lt;/td&gt;&lt;td style="width:33%;padding:0.5em;"&gt;
'
{end}     = '&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
'

{column1}
#### Column One
Rutrum imperdiet vitae vitae a suscipit semper potenti magna.

Proin id justo vestibulum rutrum neque consequat in nam morbi orci at.

  Feugiat habitant donec. Sem tincidunt arcu pellentesque suscipit
  accumsan.

{column2}
#### Column Two
Proin id Ante praesent scelerisque ligula vivamus in.

Amet neque ut enim molestiae est. Dictumst magna orci magnis donec
lectus lectus at sapien.

&gt; Vivamus et metus. In a ut. Enim in lorem.

{column3}
#### Column Three
Quibusdam suspendisse volutpat.

Pellentesque nunc lectus tellus cursus fusce.

.sidebar
Tincidunt proin lorem. Mi vel ut. Duis ipsum nam eget vitae ut
consequat quisque duis mollis magna arcu.

{end}
</code></pre>
<textarea id="columnar-text-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('columnar-text-example')"></textarea>
</td>
</tr>
<tr><td class="example-header" style="width:10%;">Rendered HTML</td>
<td>
<div id="columnar-text-example-rendered" class="example-rendered">
<table><tr><td style="width:33%;padding:0.5em;">
<h4>Column One</h4>
<p>Rutrum imperdiet vitae vitae a suscipit semper potenti magna.</p>
<p>Proin id justo vestibulum rutrum neque consequat in nam morbi orci at.</p>
<pre class="no-highlight"><code>Feugiat habitant donec. Sem tincidunt arcu pellentesque suscipit
accumsan.</code></pre>
</td><td style="width:33%;padding:0.5em;">
<h4>Column Two</h4>
<p>Proin id Ante praesent scelerisque ligula vivamus in.</p>
<p>Amet neque ut enim molestiae est. Dictumst magna orci magnis donec
lectus lectus at sapien.</p>
<blockquote><p> Vivamus et metus. In a ut. Enim in lorem.</p></blockquote>
</td><td style="width:33%;padding:0.5em;">
<h4>Column Three</h4>
<p>Quibusdam suspendisse volutpat.</p>
<p>Pellentesque nunc lectus tellus cursus fusce.</p>
<p class="sidebar">Tincidunt proin lorem. Mi vel ut. Duis ipsum nam eget vitae ut
consequat quisque duis mollis magna arcu.</p>
</td></tr></table>
</div>
</td></tr></table>
<h2>Macro meta-programming</h2>
<p>You can define macros which, when invoked, generate other macros. A
good example of this is the generation of document section headers,
links and table of contents entries from a section identifier and
title.</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header" style="width:10%;">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('meta-macros-example')">&#x270e;</span>
Rimu source</td>
<td>
<pre id="meta-macros-example-source" class="example-source no-highlight"><code>// toc macro generates section TOC entry, link macro, header macro.
// $1 = section ID, $2 = section title.
{toc} = '{$1} = '&lt;#$1|$2&gt;' \
{$1-header} = '.#$1
## $2' \
{$1}
'

#### Table of Contents
{toc|section1|Section One}
{toc|section2|Section Two}

{section1-header}
Link to {section2}.

{section2-header}
Link to {section1}.</code></pre>
<textarea id="meta-macros-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('meta-macros-example')"></textarea>
</td>
</tr>
<tr><td class="example-header" style="width:10%;">Rendered HTML</td>
<td>
<div id="meta-macros-example-rendered" class="example-rendered">
<h4>Table of Contents</h4>
<p><a href="#section1">Section One</a></p>
<p><a href="#section2">Section Two</a></p>
<h2 id="section1">Section One</h2>
<p>Link to <a href="#section2">Section Two</a>.</p>
<h2 id="section2">Section Two</h2>
<p>Link to <a href="#section1">Section One</a>.</p>
</div>
</td></tr></table>
<p><b>NOTE</b>: The backslash character is used to continue macro definition
lines that end with a single-quote.</p>
<h2>Macro tips</h2>
<ul><li>Use the <code>&amp;vert;</code> character entity to display a <code>|</code> character inside
  a macro parameter value.
</li><li>Closing block delimiters must be explicit and cannot be sourced from
  a macro invocation (because Rimu elements are recognized before
  macro expansion).
</li><li>The contents of a macro can be rendered verbatim in a code block by
  enabling macro expansion. For example:
<pre class="no-highlight"><code>.-macros
```
{example-42}
```</code></pre>
<p>The contents of <code>{example-42}</code> are not subject to further macro expansion.</p>
</li><li>Definition elements cannot be prefixed with an Inclusion/Exclusion
  macro (see <a href="#conditional-inclusion">Conditional Inclusion</a>).
</li><li>Macro invocations in macro definition values are expanded when the
  macro is declared, not when it is invoked. You can defer evaluation
  until the macro is invoked by escaping macro invocations or (in the
  case of multi-line definitions) by using the <code>-macros</code> <em>Block
  Attributes</em> option. For example this Rimu markup:
<pre class="no-highlight"><code>{m1} = 'foo'
{m2} = '{m1} \{m1}'
{m2}

{m1} = 'bar'
{m2}</code></pre>
<p>Generates:</p>
<pre class="no-highlight"><code>&lt;p&gt;foo foo&lt;/p&gt;
&lt;p&gt;foo bar&lt;/p&gt;</code></pre>
</li></ul><h2>List item counters</h2>
<p>In addition to the <em>verse</em> and <em>sidebar</em> CSS styles the  <a href="reference.html#rimuc-command">rimuc</a> tool
<code>--styled</code> option also includes CSS classes for counting list items
and for numbering labeled list items.</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('list-item-counters-example')">&#x270e;</span>
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="list-item-counters-example-source" class="example-source no-highlight"><code>#### Numbered labeled list
.dl-numbered
One:: Item one.
Two:: Item two.
Three:: Item three.

.dl-counter
labeled list items.

#### Counted unordered list
- Item one.
- Item two.
- Item three.
- Item four.

.ul-counter
unordered list items.

#### Counted ordered list
. Item one.
. Item two.

.ol-counter
ordered list items.</code></pre>
<textarea id="list-item-counters-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('list-item-counters-example')"></textarea>
</td>
<td style="width:50%;">
<div id="list-item-counters-example-rendered" class="example-rendered">
<h4>Numbered labeled list</h4>
<dl class="dl-numbered"><dt>One</dt><dd> Item one.
</dd><dt>Two</dt><dd> Item two.
</dd><dt>Three</dt><dd> Item three.
</dd></dl><p class="dl-counter">labeled list items.</p>
<h4>Counted unordered list</h4>
<ul><li>Item one.
</li><li>Item two.
</li><li>Item three.
</li><li>Item four.
</li></ul><p class="ul-counter">unordered list items.</p>
<h4>Counted ordered list</h4>
<ol><li>Item one.
</li><li>Item two.
</li></ol><p class="ol-counter">ordered list items.</p>
</div>
</td></tr></table>
<h2>Include arbitrary elements in list items</h2>
<p>An attached <em>Division Block</em> can be used to group and append arbitrary
block elements to a list item.</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('composite-list-item-example')">&#x270e;</span>
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="composite-list-item-example-source" class="example-source no-highlight"><code>- First list item.
..
Include a paragraph in the list item.

&gt; And a Quoted paragraph.
..
- Second list item.</code></pre>
<textarea id="composite-list-item-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('composite-list-item-example')"></textarea>
</td>
<td style="width:50%;">
<div id="composite-list-item-example-rendered" class="example-rendered">
<ul><li>First list item.
<p>Include a paragraph in the list item.</p>
<blockquote><p> And a Quoted paragraph.</p></blockquote>
</li><li>Second list item.
</li></ul></div>
</td></tr></table>
<p>This works because if a <a href="reference.html#fenced-blocks">Fenced Block</a>
immediately follows a list item without any intervening blank lines
it will be rendered with the list item.</p>
<h2>Block Attributes within lists</h2>
<p>To apply <em>Block Attributes</em> elements to a nested list or an attached
element, envelope the Block Attributes and the attached element in a
<em>Division Block</em> (this is a specific application of the <a href="#include-arbitrary-elements-in-list-items">previous
tip</a>).</p>
<p>Note the use of a <a href="#nested-fenced-blocks">nested Division block</a> in
the first list item in the example below.</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('list-item-block-attributes-example')">&#x270e;</span>
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="list-item-block-attributes-example-source" class="example-source no-highlight"><code>- List item with green sidebar
  styled Division block.
..
.sidebar "color:green"
...
Urna aliquam pid, pulvinar augue ut
aenean enim cum lectus sed.

Duis odio lectus, augue non egestas
amet? Magna lectus?
...
..

- List item with verse styled
  paragraph.
..
.verse
Urna aliquam pid,
pulvinar augue ut,
aenean enim cum.
..

- List item with nested numbered
  [labeled list](#example-list).
..
.dl-numbered #example-list
One:: Item one.
Two:: Item two.
Three:: Item three.
..

- List item with bold Indented
  paragraph.
..
."font-weight:bold"
  Duis in tincidunt rhoncus nascetur
  lacus!
..</code></pre>
<textarea id="list-item-block-attributes-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('list-item-block-attributes-example')"></textarea>
</td>
<td style="width:50%;">
<div id="list-item-block-attributes-example-rendered" class="example-rendered">
<ul><li>List item with green sidebar
  styled Division block.
<div class="sidebar" style="color:green"><p>Urna aliquam pid, pulvinar augue ut
aenean enim cum lectus sed.</p>
<p>Duis odio lectus, augue non egestas
amet? Magna lectus?</p></div>
</li><li>List item with verse styled
  paragraph.
<p class="verse">Urna aliquam pid,
pulvinar augue ut,
aenean enim cum.</p>
</li><li>List item with nested numbered
  <a href="#example-list">labeled list</a>.
<dl class="dl-numbered" id="example-list"><dt>One</dt><dd> Item one.
</dd><dt>Two</dt><dd> Item two.
</dd><dt>Three</dt><dd> Item three.
</dd></dl>
</li><li>List item with bold Indented
  paragraph.
<pre style="font-weight:bold" class="no-highlight"><code>Duis in tincidunt rhoncus nascetur
lacus!</code></pre>
</li></ul></div>
</td></tr></table>
<h2>Section numbering</h2>
<p>Use the <a href="reference.html#rimuc-command">rimuc</a> <code>--section-numbers</code> option with the <code>--styled</code> option
to number top level <em>h2</em> and <em>h3</em> sub-sections. For example:</p>
<pre class="no-highlight"><code>rimuc --styled --section-numbers mydoc.rmu</code></pre>
<p>The  <a href="reference.html#rimuc-command">rimuc</a> <code>--section-numbers</code> option is a shortcut for
` = 'yes'`.</p>
<h2>Nested Fenced Blocks</h2>
<p><a href="reference.html#fenced-blocks">Fenced blocks</a> of the same type can be
nested by using differing numbers of delimiter characters to
distinguish between them.</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('nested-fenced-blocks-example')">&#x270e;</span>
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="nested-fenced-blocks-example-source" class="example-source no-highlight"><code>""
Urna aliquam pid, pulvinar augue ut
aenean enim cum lectus sed, duis odio
lectus, augue non egestas amet? Magna
lectus?

"""
Enim ultricies odio rhoncus ultrices,
adipiscing in dictumst in, enim integer
vel mauris placerat in phasellus magna.
"""

Duis in tincidunt rhoncus nascetur
lacus!
""</code></pre>
<textarea id="nested-fenced-blocks-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('nested-fenced-blocks-example')"></textarea>
</td>
<td style="width:50%;">
<div id="nested-fenced-blocks-example-rendered" class="example-rendered">
<blockquote><p>Urna aliquam pid, pulvinar augue ut
aenean enim cum lectus sed, duis odio
lectus, augue non egestas amet? Magna
lectus?</p>
<blockquote><p>Enim ultricies odio rhoncus ultrices,
adipiscing in dictumst in, enim integer
vel mauris placerat in phasellus magna.</p></blockquote>
<p>Duis in tincidunt rhoncus nascetur
lacus!</p></blockquote>
</div>
</td></tr></table>
<h2>List termination</h2>
<p>List termination can be forced by following the list by two or more blank
lines. This comes in handy if you want to follow one list immediately by
another or if you want to separate an Indented paragraph from a
preceding list.</p>
<h2>Nested list item ambiguity</h2>
<p>To render an indented list item as an Indented paragraph change it
to a fenced code block.</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('list-ambiguity-example')">&#x270e;</span>
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="list-ambiguity-example-source" class="example-source no-highlight"><code>- List item.

  * Rendered as nested list item.

- List item.
``
* Rendered as code block.
``</code></pre>
<textarea id="list-ambiguity-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('list-ambiguity-example')"></textarea>
</td>
<td style="width:50%;">
<div id="list-ambiguity-example-rendered" class="example-rendered">
<ul><li>List item.
<ul><li>Rendered as nested list item.
</li></ul></li><li>List item.
<pre class="no-highlight"><code>* Rendered as code block.</code></pre>
</li></ul></div>
</td></tr></table>
<h2>Controlling line breaks</h2>
<p>There are three ways to inhibit text wrapping and preserve line
breaks:</p>
<ol><li>Terminate lines with a Rimu line break (a space followed by a
  backslash character).
</li><li>Terminate lines with an HTML break element (<code>&lt;br&gt;</code>).
</li><li>Inject the <code>line-breaks</code> CSS class into a Rimu block element and
  compile with the <code>rimuc</code> command <code>--styled</code> option.
</li></ol><h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('line-breaks-example')">&#x270e;</span>
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="line-breaks-example-source" class="example-source no-highlight"><code>Urna aliquam pid \
Aenean enim cum sed &lt;br&gt;
Augue non egestas amet?

.line-breaks
Urna aliquam pid
Aenean enim cum sed
Augue non egestas amet?
</code></pre>
<textarea id="line-breaks-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('line-breaks-example')"></textarea>
</td>
<td style="width:50%;">
<div id="line-breaks-example-rendered" class="example-rendered">
<p>Urna aliquam pid<br>
Aenean enim cum sed <br>
Augue non egestas amet?</p>
<p class="line-breaks">Urna aliquam pid
Aenean enim cum sed
Augue non egestas amet?</p>
</div>
</td></tr></table>
<h2>Controlling page breaks</h2>
<p>You can control printer page breaks by using Rimu <em>Attribute Blocks</em>
to inject CSS
<a href="https://developer.mozilla.org/en/docs/Web/CSS/page-break-inside">page-break-inside</a>,
<a href="https://developer.mozilla.org/en/docs/Web/CSS/page-break-before">page-break-before</a>
and
<a href="https://developer.mozilla.org/en/docs/Web/CSS/page-break-after">page-break-after</a>
properties into HTML output elements.</p>
<p>Examples:</p>
<pre class="no-highlight"><code>.sidebar "page-break-inside:avoid"
..
Page breaks are avoided inside
this sidebar.
..

."page-break-before:always"
### A header that starts on a new page</code></pre>
<p>The <a href="reference.html#rimuc-command">rimuc</a> tool <code>--styled</code> option includes <code>page-break</code> and
<code>no-page-break</code> CSS classes which apply <code>page-break-before:always</code> and
<code>page-break-inside:avoid</code> properties respectively.  Here is the
previous example using the <a href="reference.html#rimuc-command">rimuc</a> page break classes:</p>
<pre class="no-highlight"><code>.sidebar no-page-break
..
Page breaks are avoided inside
this sidebar.
..

.page-break
### A header that starts on a new page</code></pre>
<h2>Controlling text alignment</h2>
<p>You can control the horizontal alignment of flowed inline elements
(e.g. text, inline images) by injecting the CSS <code>text-align</code> property
into the container block element using the Rimu <em>Attribute Blocks</em>
element. For example:</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('text-alignment-example-1')">&#x270e;</span>
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="text-alignment-example-1-source" class="example-source no-highlight"><code>."text-align:center"
Enim odio ultrices</code></pre>
<textarea id="text-alignment-example-1-edit" class="edit-source" style="display:none" onkeyup="updateExample('text-alignment-example-1')"></textarea>
</td>
<td style="width:50%;">
<div id="text-alignment-example-1-rendered" class="example-rendered">
<p style="text-align:center">Enim odio ultrices</p>
</div>
</td></tr></table>
<p>The <a href="reference.html#rimuc-command">rimuc</a> tool <code>--styled</code> option includes <code>align-left</code>,
<code>align-center</code> and <code>align-right</code> CSS classes.  Here is the previous
example using the <code>align-center</code> text alignment class:</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('text-alignment-example-2')">&#x270e;</span>
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="text-alignment-example-2-source" class="example-source no-highlight"><code>.align-center
Enim odio ultrices</code></pre>
<textarea id="text-alignment-example-2-edit" class="edit-source" style="display:none" onkeyup="updateExample('text-alignment-example-2')"></textarea>
</td>
<td style="width:50%;">
<div id="text-alignment-example-2-rendered" class="example-rendered">
<p class="align-center">Enim odio ultrices</p>
</div>
</td></tr></table>
<h2>Citing quotes and verses</h2>
<p>The <a href="reference.html#rimuc-command">rimuc</a> command <code>--styled</code> option includes the CSS <em>cite</em> class
for attributing quotes and verses. For example:</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('citation-example')">&#x270e;</span>
Rimu source</td>
<td class="example-header">Rendered HTML</td>
</tr>
<tr>
<td style="width:50%;">
<pre id="citation-example-source" class="example-source no-highlight"><code>Quotation:

""
Enim ultricies odio rhoncus ultrices,
porttitor augue a amet, pulvinar
adipiscing in dictumst in, enim integer
vel mauris placerat in phasellus magna.
Nisi! Amet.

.cite
Anonymous
""

Verse:

.verse
..
Urna aliquam pid
Aenean enim cum sed
Augue non egestas amet?

.cite
A. N. Mouse
..</code></pre>
<textarea id="citation-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('citation-example')"></textarea>
</td>
<td style="width:50%;">
<div id="citation-example-rendered" class="example-rendered">
<p>Quotation:</p>
<blockquote><p>Enim ultricies odio rhoncus ultrices,
porttitor augue a amet, pulvinar
adipiscing in dictumst in, enim integer
vel mauris placerat in phasellus magna.
Nisi! Amet.</p>
<p class="cite">Anonymous</p></blockquote>
<p>Verse:</p>
<div class="verse"><p>Urna aliquam pid
Aenean enim cum sed
Augue non egestas amet?</p>
<p class="cite">A. N. Mouse</p></div>
</div>
</td></tr></table>
<h2>An example letter</h2>
<p>Here's an example of a personal letter:</p>
<h4>Examples</h4>
<table class="example bordered">
<tr>
<td class="example-header" style="width:10%;">
<span class="edit-icon no-print" style="cursor:pointer" title="Edit example" onclick="editExample('letter-example')">&#x270e;</span>
Rimu source</td>
<td>
<pre id="letter-example-source" class="example-source no-highlight"><code>."font-family:serif; font-size:12pt;"
.....................................

."margin-left:75%"
..
24 Milky Way \
Skyhome 1234 \

17th June 2016
..

."margin-bottom:1.5em"
Mr. A. N. Mouse \
P.O. Box 42     \
Riverbank 3120

."margin-bottom:1.2em"
Dear Andrew

Mattis pellentesque in lundium lectus penatibus turpis enim enim in,
mid velit. Eu lundium. Lundium! Porttitor! Porttitor purus lacus et
odio nisi amet in magna penatibus odio amet?

In urna rhoncus! Nec scelerisque enim in turpis pid, phasellus cras,
rhoncus, egestas aliquet lundium! Lundium auctor vel natoque enim.

."margin-top:2em"
Yours sincerely \
Joe Jetson
.....................................
</code></pre>
<textarea id="letter-example-edit" class="edit-source" style="display:none" onkeyup="updateExample('letter-example')"></textarea>
</td>
</tr>
<tr><td class="example-header" style="width:10%;">Rendered HTML</td>
<td>
<div id="letter-example-rendered" class="example-rendered">
<div style="font-family:serif; font-size:12pt;"><div style="margin-left:75%"><p>24 Milky Way<br>
Skyhome 1234<br></p>
<p>17th June 2016</p></div>
<p style="margin-bottom:1.5em">Mr. A. N. Mouse<br>
P.O. Box 42    <br>
Riverbank 3120</p>
<p style="margin-bottom:1.2em">Dear Andrew</p>
<p>Mattis pellentesque in lundium lectus penatibus turpis enim enim in,
mid velit. Eu lundium. Lundium! Porttitor! Porttitor purus lacus et
odio nisi amet in magna penatibus odio amet?</p>
<p>In urna rhoncus! Nec scelerisque enim in turpis pid, phasellus cras,
rhoncus, egestas aliquet lundium! Lundium auctor vel natoque enim.</p>
<p style="margin-top:2em">Yours sincerely<br>
Joe Jetson</p></div>
</div>
</td></tr></table>
<ul><li>The font parameters are set by enclosing the entire contents in a
  Division Block.
</li><li>If you want to control the print margins put something like this at
  the start of the document:
<pre class="no-highlight"><code>&lt;style&gt;
@page
{ margin: 25mm 25mm 25mm 25mm; }
&lt;/style&gt;</code></pre>
</li></ul><h2>Automatically recompile and display Rimu source</h2>
<p>To automatically recompile Rimu source to HTML and refresh the webpage
in the Chrome browser use <a href="http://entrproject.org/">entr(1)</a> to
recompile, for example:</p>
<pre class="no-highlight"><code>ls README.md | entr rimuc -s README.md</code></pre>
<p>Then use the Chrome
<a href="https://chrome.google.com/webstore/detail/livepage/pilnojpmdoofaelbinaeodfpjheijkbh">LivePage</a>
extension to auto-refresh the file after it is recompiled.</p>
<h2>General purpose macro processor</h2>
<p>You can use Rimu as a general purpose macro text processor. This is
achieved by enveloping the text to be processed in a <em>Division Block</em>.
For example:</p>
<pre class="no-highlight"><code>// Macro definitions.
{sans-font} = 'Arial, Helvetica, sans-serif'
{primary-color} = '#527bbd'
{primary-background} = 'white'
{text-color} = '#333333'

// Only expand macros in Division Block.
.-spans -specials -container
..
body {
  font-family: {sans-font};
  font-size: 14px;
  line-height: 20px;
  color: {text-color};
  background-color: {primary-background};
  margin: 1em;
  max-width: 50em;
}

h1, h2, h3, h4, h5, h6 {
  margin: 10px 0;
  color: {primary-color};
}
..</code></pre>
<ul><li>Use <code>rimuc</code> to expand the macros, for example:
<pre class="no-highlight"><code>rimuc --output main.css main.rmu</code></pre>
</li><li>This technique can be combined with <em>conditional macro expansion</em> and all the other
  Rimu <em>macro features</em>.
</li></ul><h2>Passing arbitrary text to the output</h2>
<p>To pass arbitrary blocks of text directly to the output disable all
processing options. For example:</p>
<pre class="no-highlight"><code>// Disable all processing inside Division Block.
.-macros -spans -specials -container
..
function toggleToc() {
    document.getElementById("toc").classList.toggle('toc-visible');
}

window.onclick = toggleToc
..</code></pre>
<p>To enable only macro expansion drop the <code>-macros</code> option
(c.f. [General purpose macro processor](#general purpose macro processor)).</p>

</div>
<script src="http://yandex.st/highlightjs/7.3/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
window.onload = function() {
  var headings = [].slice.call(document.body.querySelectorAll('#article > h1, #article > h2, #article > h3'));
  headings.forEach(function(heading) {
    var title = heading.textContent;
    var id = heading.getAttribute('id');
    if (!id) {
      id = slugify(title);
      heading.setAttribute('id', id);
    }
    appendTocEntry(heading, id);
  });
}
function slugify(text) {
  var slug = text.replace(/\s+/g, '-') // Replace spaces with dashes.
      .replace(/[^\w-]/g, '')          // Retain alphanumeric, '-' and '_' characters.
      .toLowerCase()
  if (!slug) slug = 'x';
  if (document.getElementById(slug)) { // Another element already has that id.
    var i = 2, prefix = slug;
    while (document.getElementById(slug = prefix + '-' + i++)) {}
  }
  return slug;
}
</script>
<script>
function appendTocEntry(heading, id) {
  if (heading.classList.contains('no-auto-toc')) {
    return;
  }
  var container = document.getElementById('auto-toc');
  if (container === null) {
    return;
  }
  var tocLink = document.createElement('a');
  tocLink.setAttribute('href', '#' + id);
  tocLink.textContent = heading.textContent;
  var tocEntry = document.createElement('div');
  tocEntry.setAttribute('class', heading.tagName.toLowerCase());
  tocEntry.appendChild(tocLink);
  container.appendChild(tocEntry);
}
</script>
</body>
</html>